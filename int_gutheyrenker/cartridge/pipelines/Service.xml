<?xml version="1.0" encoding="UTF-8" ?>
<?demandware-pipeline version="2.0"?>

<pipeline group="Application" type="view">
  <branch basename="Test">
    <segment>
      <node>
        <start-node name="Test" secure="true"/>
        <node-display x="1" y="1"/>
      </node>
      <simple-transition/>
      <node>
        <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <key-binding alias="CurrentHttpParameterMap.messageMethod.stringValue" key="From_0"/>
          <key-binding alias="MessageMethod" key="To_0"/>
          <key-binding alias="CurrentHttpParameterMap.messageBody.stringValue" key="From_1"/>
          <key-binding alias="MessageBody" key="To_1"/>
          <key-binding alias="MessagePath" key="To_2"/>
          <key-binding alias="MessageURL" key="To_3"/>
          <key-binding alias="null" key="From_6"/>
          <key-binding alias="null" key="To_6"/>
          <key-binding alias="null" key="From_7"/>
          <key-binding alias="null" key="To_7"/>
          <key-binding alias="null" key="From_8"/>
          <key-binding alias="null" key="To_8"/>
          <key-binding alias="null" key="From_9"/>
          <key-binding alias="null" key="To_9"/>
          <key-binding alias="CurrentHttpParameterMap.messagePath.stringValue" key="From_2"/>
          <key-binding alias="CurrentHttpParameterMap.url.stringValue" key="From_3"/>
          <key-binding alias="CurrentHttpParameterMap.contentType.stringValue" key="From_4"/>
          <key-binding alias="ContentType" key="To_4"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
      </node>
      <simple-transition/>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="testbed/TestBed.ds"/>
          <config-property key="Timeout" value="30"/>
          <key-binding alias="ScriptLog" key="ScriptLog"/>
          <key-binding alias="MessageBody" key="MessageBody"/>
          <key-binding alias="MessageMethod" key="MessageMethod"/>
          <key-binding alias="MessageResponse" key="MessageResponse"/>
          <key-binding alias="MessageResponseHeaders" key="MessageResponseHeaders"/>
          <key-binding alias="MessageStatus" key="MessageStatus"/>
          <key-binding alias="MessagePassword" key="MessagePassword"/>
          <key-binding alias="MessageURL" key="MessageURL"/>
          <key-binding alias="MessageUsername" key="MessageUsername"/>
          <key-binding alias="MessagePath" key="MessagePath"/>
          <key-binding alias="MessageRequestHeader" key="MessageRequestHeader"/>
          <key-binding alias="ContentType" key="ContentType"/>
          <key-binding alias="SignatureString" key="SignatureString"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="1" y="0"/>
              <bend-point relative-to="source" x="1" y="-1"/>
              <bend-point relative-to="target" x="0" y="-1"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                <config-property key="Transactional" value="false"/>
                <key-binding alias="ScriptLog" key="From_0"/>
                <key-binding alias="MessageResponse" key="To_0"/>
                <key-binding alias="null" key="From_1"/>
                <key-binding alias="null" key="To_1"/>
                <key-binding alias="null" key="From_2"/>
                <key-binding alias="null" key="To_2"/>
                <key-binding alias="null" key="From_3"/>
                <key-binding alias="null" key="To_3"/>
                <key-binding alias="null" key="From_4"/>
                <key-binding alias="null" key="To_4"/>
                <key-binding alias="null" key="From_5"/>
                <key-binding alias="null" key="To_5"/>
                <key-binding alias="null" key="From_6"/>
                <key-binding alias="null" key="To_6"/>
                <key-binding alias="null" key="From_7"/>
                <key-binding alias="null" key="To_7"/>
                <key-binding alias="null" key="From_8"/>
                <key-binding alias="null" key="To_8"/>
                <key-binding alias="null" key="From_9"/>
                <key-binding alias="null" key="To_9"/>
              </pipelet-node>
              <node-display x="1" y="0"/>
            </node>
            <transition target-connector="in2" target-path="../+1">
              <transition-display>
                <bend-point relative-to="source" x="0" y="2"/>
              </transition-display>
            </transition>
          </segment>
        </branch>
      </node>
      <transition target-connector="in1" target-path="./+1"/>
    </segment>
    <segment>
      <node>
        <join-node/>
        <node-display x="0" y="1"/>
      </node>
      <simple-transition/>
      <node>
        <interaction-node transaction-required="false">
          <template buffered="true" dynamic="false" name="util/testbed"/>
        </interaction-node>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="Example">
    <segment>
      <node>
        <start-node name="Example" secure="true"/>
        <node-display x="3" y="1"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="target" x="0" y="-1"/>
        </transition-display>
      </simple-transition>
      <node>
        <interaction-node transaction-required="false">
          <template buffered="true" dynamic="false" name="util/testservice"/>
        </interaction-node>
        <node-display x="0" y="2"/>
      </node>
    </segment>
  </branch>
  <branch basename="_ANONYMOUS_BRANCH_3">
    <segment>
      <node>
        <text-node>
          <description>To be used in COPlaceOrder-Start, after Order has been transactionally created

Assumes:
- Basket
- Order

both must exist</description>
        </text-node>
        <node-display x="6" y="0"/>
      </node>
    </segment>
  </branch>
  <branch basename="Encrypt">
    <segment>
      <node>
        <start-node name="Encrypt" secure="false"/>
        <node-display x="4" y="1"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="target" x="0" y="-1"/>
        </transition-display>
      </simple-transition>
      <node>
        <interaction-node transaction-required="false">
          <template buffered="true" dynamic="false" name="util/hellotest"/>
        </interaction-node>
        <node-display x="0" y="2"/>
      </node>
    </segment>
  </branch>
  <branch basename="CopyValidatorInfo">
    <segment>
      <node>
        <start-node call-mode="private" name="CopyValidatorInfo" secure="false"/>
        <node-display x="6" y="1"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <decision-node condition-key="!empty(Basket)" condition-operator="expr"/>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="yes">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="0" y="1"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                <config-property key="Transactional" value="false"/>
                <key-binding alias="Basket.custom.transactionId" key="From_0"/>
                <key-binding alias="TransactionId" key="To_0"/>
                <key-binding alias="Basket.custom.validatorId" key="From_1"/>
                <key-binding alias="ValidatorId" key="To_1"/>
                <key-binding alias="Basket.custom.preAuthId" key="From_2"/>
                <key-binding alias="PreAuthId" key="To_2"/>
                <key-binding alias="Basket.custom.uciCode" key="From_3"/>
                <key-binding alias="UciCode" key="To_3"/>
                <key-binding alias="Basket.custom.campaignCode" key="From_4"/>
                <key-binding alias="CampaignCode" key="To_4"/>
                <key-binding alias="Basket.custom.accountPassword" key="From_5"/>
                <key-binding alias="AccountPassword" key="To_5"/>
                <key-binding alias="Basket.custom.userInfoAge" key="From_6"/>
                <key-binding alias="UserInfoAge" key="To_6"/>
                <key-binding alias="Basket.custom.userInfoGender" key="From_7"/>
                <key-binding alias="UserInfoGender" key="To_7"/>
                <key-binding alias="Basket.custom.customerIPAddress" key="From_8"/>
                <key-binding alias="CustomerIPAddress" key="To_8"/>
                <key-binding alias="CurrentCampaignConfig.cartID" key="From_9"/>
                <key-binding alias="CartID" key="To_9"/>
              </pipelet-node>
              <node-display x="0" y="1"/>
            </node>
            <simple-transition>
              <transition-display>
                <bend-point relative-to="source" x="0" y="1"/>
              </transition-display>
            </simple-transition>
            <node>
              <end-node name="ok"/>
              <node-display x="0" y="1"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="1" y="0"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node name="error"/>
        <node-display orientation="horizontal" x="1" y="0"/>
      </node>
    </segment>
  </branch>
  <branch basename="RegistrationStatus">
    <segment>
      <node>
        <start-node call-mode="private" name="RegistrationStatus" secure="false"/>
        <node-display x="8" y="3"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="grmiddleware/CustomerOnlineRegistration.ds"/>
          <key-binding alias="log" key="ScriptLog"/>
          <key-binding alias="email" key="Username"/>
          <key-binding alias="password" key="Password"/>
          <key-binding alias="status" key="Status"/>
          <key-binding alias="status" key="statusMessage"/>
          <key-binding alias="CurrentForms.profile.customer.email.value" key="email"/>
          <key-binding alias="CurrentForms.profile.login.password.value" key="password"/>
          <key-binding alias="CurrentForms.profile.customer.accountNumber.value" key="accountNumber"/>
          <key-binding alias="CurrentForms.profile.customer.firstname.value" key="firstName"/>
          <key-binding alias="CurrentForms.profile.customer.lastname.value" key="lastName"/>
          <key-binding alias="CurrentForms.profile.customer.phone.value" key="phone"/>
          <key-binding alias="CurrentForms.profile.customer.billingZipCode.value" key="postalCode"/>
          <key-binding alias="&quot;PA&quot;" key="brandId"/>
          <key-binding alias="&quot;DW&quot;" key="clientId"/>
          <key-binding alias="CurrentRequest.httpRemoteAddress" key="ipAddress"/>
          <key-binding alias="CurrentSession.sessionID" key="sessionId"/>
          <key-binding alias="&quot;12233445514&quot;" key="transactionID"/>
          <key-binding alias="CurrentRequest" key="uid"/>
          <key-binding alias="CurrentForms.profile" key="profileForm"/>
          <key-binding alias="errorCode" key="errorcode"/>
          <key-binding alias="isMember" key="member"/>
          <key-binding alias="mwid" key="mwid"/>
          <key-binding alias="status" key="status"/>
          <key-binding alias="errorMessage" key="errormessage"/>
          <key-binding alias="responseXML" key="responseXML"/>
          <key-binding alias="CurrentRequest" key="Request"/>
          <key-binding alias="customerStatus" key="CustomerStatus"/>
          <key-binding alias="customerStatusCode" key="customerStatusCode"/>
          <key-binding alias="CustomerSegment" key="CustomerSegment"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="1" y="0"/>
              <bend-point relative-to="source" x="1" y="-1"/>
              <bend-point relative-to="target" x="0" y="-1"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <call-node start-name-ref="Service-ScriptError"/>
              <node-display x="1" y="0"/>
            </node>
            <transition target-connector="in1" target-path="../+1"/>
          </segment>
        </branch>
      </node>
      <simple-transition/>
      <node>
        <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <key-binding alias="dw.web.Resource.msg('site.temporary.brand','configuration',null)" key="From_1"/>
          <key-binding alias="CustomerBrand" key="To_1"/>
          <key-binding alias="null" key="From_2"/>
          <key-binding alias="null" key="To_2"/>
          <key-binding alias="null" key="From_3"/>
          <key-binding alias="null" key="To_3"/>
          <key-binding alias="null" key="From_4"/>
          <key-binding alias="null" key="To_4"/>
          <key-binding alias="null" key="From_5"/>
          <key-binding alias="null" key="To_5"/>
          <key-binding alias="null" key="From_6"/>
          <key-binding alias="null" key="To_6"/>
          <key-binding alias="null" key="From_7"/>
          <key-binding alias="null" key="To_7"/>
          <key-binding alias="null" key="From_8"/>
          <key-binding alias="null" key="To_8"/>
          <key-binding alias="null" key="From_9"/>
          <key-binding alias="null" key="To_9"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
      </node>
      <simple-transition/>
      <node>
        <decision-node condition-key="status == '200'" condition-operator="expr"/>
        <node-display x="0" y="1"/>
        <branch basename="b3" source-connector="yes">
          <transition target-connector="in"/>
          <segment>
            <node>
              <end-node name="Ok"/>
              <node-display x="0" y="1"/>
            </node>
          </segment>
        </branch>
      </node>
      <transition target-connector="in2" target-path="./+1"/>
    </segment>
    <segment>
      <node>
        <join-node/>
        <node-display x="1" y="0"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node name="Error"/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="_ANONYMOUS_BRANCH_7">
    <segment>
      <node>
        <text-node>
          <description>Login Request API CALL and Fetching the Customer Request</description>
        </text-node>
        <node-display x="12" y="0"/>
      </node>
    </segment>
  </branch>
  <branch basename="FetchCustomer">
    <segment>
      <node>
        <start-node call-mode="private" name="FetchCustomer" secure="false"/>
        <node-display x="12" y="1"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="service/GetCustomer.ds"/>
          <key-binding alias="log" key="ScriptLog"/>
          <key-binding alias="CurrentForms.login.username.value" key="Login"/>
          <key-binding alias="CurrentForms.login.password.value" key="Password"/>
          <key-binding alias="loginAuthenticated" key="loginstatus"/>
          <key-binding alias="changepassword" key="changepassword"/>
          <key-binding alias="accountstatus" key="accountstatus"/>
          <key-binding alias="profile" key="profile"/>
          <key-binding alias="CurrentCustomer" key="CurrentCustomer"/>
          <key-binding alias="CurrentForms.profile" key="ProfileForm"/>
          <key-binding alias="CurrentForms.login.username.value" key="emailId"/>
          <key-binding alias="CurrentForms.login.password.value" key="password"/>
          <key-binding alias="CurrentSession.sessionID" key="sessionId"/>
          <key-binding alias="CurrentRequest.getHttpRemoteAddress()" key="remoteIP"/>
          <key-binding alias="responseXML" key="responseXMLObject"/>
          <key-binding alias="loginAuthenticated" key="loginAuthenticated"/>
          <key-binding alias="&quot;12233445514&quot;" key="transactionID"/>
          <key-binding alias="&quot;VHgNyZ&quot;" key="uid"/>
          <key-binding alias="customerStatusCode" key="CustomerStatusCode"/>
          <key-binding alias="tempPassword" key="tempPassword"/>
          <key-binding alias="CurrentRequest" key="Request"/>
          <key-binding alias="customerStatus" key="CustomerStatus"/>
          <key-binding alias="member" key="member"/>
          <key-binding alias="CustomerSegment" key="CustomerSegment"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in1"/>
          <segment>
            <node>
              <join-node/>
              <node-display x="4" y="0"/>
            </node>
            <transition target-connector="in2" target-path="../+2"/>
          </segment>
        </branch>
      </node>
      <simple-transition/>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="service/GetCustomerBrand.ds"/>
          <key-binding alias="null" key="ScriptLog"/>
          <key-binding alias="CustomerSegment" key="Segment"/>
          <key-binding alias="CustomerBrand" key="CustomerBrand"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b3" source-connector="error">
          <transition target-connector="in2" target-path="./+1"/>
        </branch>
      </node>
      <transition target-connector="in1" target-path="./+1"/>
    </segment>
    <segment>
      <node>
        <join-node/>
        <node-display x="0" y="1"/>
      </node>
      <simple-transition/>
      <node>
        <decision-node condition-key="loginAuthenticated=='true' &amp;&amp; member=='true'" condition-operator="expr"/>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="yes">
          <transition target-connector="in"/>
          <segment>
            <node>
              <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                <config-property key="Transactional" value="false"/>
                <key-binding alias="customerStatusCode" key="From_0"/>
                <key-binding alias="CurrentSession.custom.customerStatusCode" key="To_0"/>
                <key-binding alias="null" key="From_1"/>
                <key-binding alias="null" key="To_1"/>
                <key-binding alias="null" key="From_2"/>
                <key-binding alias="null" key="To_2"/>
                <key-binding alias="null" key="From_3"/>
                <key-binding alias="null" key="To_3"/>
                <key-binding alias="null" key="From_4"/>
                <key-binding alias="null" key="To_4"/>
                <key-binding alias="null" key="From_5"/>
                <key-binding alias="null" key="To_5"/>
                <key-binding alias="null" key="From_6"/>
                <key-binding alias="null" key="To_6"/>
                <key-binding alias="null" key="From_7"/>
                <key-binding alias="null" key="To_7"/>
                <key-binding alias="null" key="From_8"/>
                <key-binding alias="null" key="To_8"/>
                <key-binding alias="null" key="From_9"/>
                <key-binding alias="null" key="To_9"/>
              </pipelet-node>
              <node-display x="0" y="1"/>
            </node>
            <simple-transition/>
            <node>
              <decision-node condition-key="(customerStatus ==&quot;member&quot;) &amp;&amp; (customerStatusCode ==&quot;1A&quot; || customerStatusCode ==&quot;4A&quot; || customerStatusCode ==&quot;4B&quot;)" condition-operator="expr"/>
              <node-display x="0" y="1"/>
              <branch basename="b2" source-connector="yes">
                <transition target-connector="in1" target-path="./b3.2"/>
              </branch>
            </node>
            <simple-transition>
              <transition-display>
                <bend-point relative-to="target" x="0" y="-1"/>
              </transition-display>
            </simple-transition>
            <node>
              <decision-node condition-key="customerStatus == dw.web.Resource.msg('Account.instantAccess','service',null)" condition-operator="expr"/>
              <node-display x="1" y="0"/>
              <branch basename="b3" source-connector="yes">
                <transition target-connector="in">
                  <transition-display>
                    <bend-point relative-to="source" x="0" y="1"/>
                  </transition-display>
                </transition>
                <segment>
                  <node>
                    <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                      <config-property key="Transactional" value="false"/>
                      <key-binding alias="new Boolean (true)" key="From_0"/>
                      <key-binding alias="CurrentSession.custom.instantAccess" key="To_0"/>
                      <key-binding alias="null" key="From_1"/>
                      <key-binding alias="null" key="To_1"/>
                      <key-binding alias="null" key="From_2"/>
                      <key-binding alias="null" key="To_2"/>
                      <key-binding alias="null" key="From_3"/>
                      <key-binding alias="null" key="To_3"/>
                      <key-binding alias="null" key="From_4"/>
                      <key-binding alias="null" key="To_4"/>
                      <key-binding alias="null" key="From_5"/>
                      <key-binding alias="null" key="To_5"/>
                      <key-binding alias="null" key="From_6"/>
                      <key-binding alias="null" key="To_6"/>
                      <key-binding alias="null" key="From_7"/>
                      <key-binding alias="null" key="To_7"/>
                      <key-binding alias="null" key="From_8"/>
                      <key-binding alias="null" key="To_8"/>
                      <key-binding alias="null" key="From_9"/>
                      <key-binding alias="null" key="To_9"/>
                    </pipelet-node>
                    <node-display x="0" y="1"/>
                  </node>
                  <transition target-connector="in1" target-path="./+1">
                    <transition-display>
                      <bend-point relative-to="source" x="0" y="2"/>
                    </transition-display>
                  </transition>
                </segment>
                <segment>
                  <node>
                    <join-node/>
                    <node-display x="-1" y="1"/>
                  </node>
                  <simple-transition/>
                  <node>
                    <end-node name="success"/>
                    <node-display x="0" y="1"/>
                  </node>
                </segment>
              </branch>
            </node>
            <simple-transition/>
            <node>
              <decision-node condition-key="customerStatus!='non-member' &amp;&amp; customerStatusCode!=&quot;2A&quot;" condition-operator="expr"/>
              <node-display orientation="horizontal" x="1" y="0"/>
              <branch basename="b4" source-connector="yes">
                <transition target-connector="in">
                  <transition-display>
                    <bend-point relative-to="source" x="1" y="0"/>
                  </transition-display>
                </transition>
                <segment>
                  <node>
                    <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                      <config-property key="Transactional" value="false"/>
                      <key-binding alias="customerStatusCode" key="From_0"/>
                      <key-binding alias="CurrentSession.custom.errorResponse" key="To_0"/>
                      <key-binding alias="dw.web.Resource.msg('error.login.unexpected','errormessages',null)" key="From_1"/>
                      <key-binding alias="genericError" key="To_1"/>
                      <key-binding alias="null" key="From_2"/>
                      <key-binding alias="null" key="To_2"/>
                      <key-binding alias="null" key="From_3"/>
                      <key-binding alias="null" key="To_3"/>
                      <key-binding alias="null" key="From_4"/>
                      <key-binding alias="null" key="To_4"/>
                      <key-binding alias="null" key="From_5"/>
                      <key-binding alias="null" key="To_5"/>
                      <key-binding alias="null" key="From_6"/>
                      <key-binding alias="null" key="To_6"/>
                      <key-binding alias="null" key="From_7"/>
                      <key-binding alias="null" key="To_7"/>
                      <key-binding alias="null" key="From_8"/>
                      <key-binding alias="null" key="To_8"/>
                      <key-binding alias="null" key="From_9"/>
                      <key-binding alias="null" key="To_9"/>
                    </pipelet-node>
                    <node-display orientation="horizontal" x="1" y="0"/>
                  </node>
                  <transition target-connector="in3" target-path="../../+2"/>
                </segment>
              </branch>
            </node>
            <simple-transition>
              <transition-display>
                <bend-point relative-to="source" x="0" y="1"/>
              </transition-display>
            </simple-transition>
            <node>
              <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                <config-property key="Transactional" value="false"/>
                <key-binding alias="dw.web.Resource.msg('error.inactive.customer','errormessages',null)" key="From_0"/>
                <key-binding alias="genericError" key="To_0"/>
                <key-binding alias="null" key="To_1"/>
                <key-binding alias="null" key="From_2"/>
                <key-binding alias="null" key="To_2"/>
                <key-binding alias="null" key="From_3"/>
                <key-binding alias="null" key="To_3"/>
                <key-binding alias="null" key="From_4"/>
                <key-binding alias="null" key="To_4"/>
                <key-binding alias="null" key="From_5"/>
                <key-binding alias="null" key="To_5"/>
                <key-binding alias="null" key="From_6"/>
                <key-binding alias="null" key="To_6"/>
                <key-binding alias="null" key="From_7"/>
                <key-binding alias="null" key="To_7"/>
                <key-binding alias="null" key="From_8"/>
                <key-binding alias="null" key="To_8"/>
                <key-binding alias="null" key="From_9"/>
                <key-binding alias="null" key="To_9"/>
              </pipelet-node>
              <node-display x="0" y="1"/>
            </node>
            <simple-transition>
              <transition-display>
                <bend-point relative-to="source" x="0" y="1"/>
              </transition-display>
            </simple-transition>
            <node>
              <jump-node start-name-ref="Account-Show"/>
              <node-display x="0" y="1"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="target" x="-1" y="0"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <key-binding alias="dw.web.Resource.msg('error.nonmember.customer','errormessages',null)" key="From_0"/>
          <key-binding alias="genericError" key="To_0"/>
          <key-binding alias="null" key="To_1"/>
          <key-binding alias="null" key="From_2"/>
          <key-binding alias="null" key="To_2"/>
          <key-binding alias="null" key="From_3"/>
          <key-binding alias="null" key="To_3"/>
          <key-binding alias="null" key="From_4"/>
          <key-binding alias="null" key="To_4"/>
          <key-binding alias="null" key="From_5"/>
          <key-binding alias="null" key="To_5"/>
          <key-binding alias="null" key="From_6"/>
          <key-binding alias="null" key="To_6"/>
          <key-binding alias="null" key="From_7"/>
          <key-binding alias="null" key="To_7"/>
          <key-binding alias="null" key="From_8"/>
          <key-binding alias="null" key="To_8"/>
          <key-binding alias="null" key="From_9"/>
          <key-binding alias="null" key="To_9"/>
        </pipelet-node>
        <node-display orientation="horizontal" x="2" y="0"/>
      </node>
      <transition target-connector="in1" target-path="./+1"/>
    </segment>
    <segment>
      <node>
        <join-node/>
        <node-display x="2" y="0"/>
      </node>
      <transition target-connector="in1" target-path="./+1"/>
    </segment>
    <segment>
      <node>
        <join-node/>
        <node-display x="0" y="2"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node name="error"/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="UpdateProfile">
    <segment>
      <node>
        <start-node call-mode="private" name="UpdateProfile" secure="false"/>
        <node-display x="17" y="2"/>
      </node>
      <simple-transition/>
      <node>
        <call-node start-name-ref="GRBrandConfigs-ProfileServiceCall"/>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="1" y="0"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <call-node start-name-ref="Service-ScriptError"/>
              <node-display orientation="horizontal" x="1" y="0"/>
            </node>
            <transition target-connector="in1" target-path="../+1"/>
          </segment>
        </branch>
      </node>
      <simple-transition/>
      <node>
        <decision-node condition-key="status ==&quot;200&quot;" condition-operator="expr"/>
        <node-display x="0" y="1"/>
        <branch basename="b3" source-connector="yes">
          <transition target-connector="in"/>
          <segment>
            <node>
              <end-node name="success">
                <description>success</description>
              </end-node>
              <node-display x="0" y="1"/>
            </node>
          </segment>
        </branch>
      </node>
      <transition target-connector="in2" target-path="./+1"/>
    </segment>
    <segment>
      <node>
        <join-node/>
        <node-display x="1" y="0"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node name="error"/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="ScriptError">
    <segment>
      <node>
        <start-node call-mode="private" name="ScriptError" secure="false"/>
        <node-display x="19" y="2"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <key-binding alias="&quot;ScriptError&quot;" key="From_0"/>
          <key-binding alias="CurrentSession.custom.errorResponseStatus" key="To_0"/>
          <key-binding alias="null" key="From_1"/>
          <key-binding alias="null" key="To_1"/>
          <key-binding alias="null" key="From_2"/>
          <key-binding alias="null" key="To_2"/>
          <key-binding alias="null" key="From_3"/>
          <key-binding alias="null" key="To_3"/>
          <key-binding alias="null" key="From_4"/>
          <key-binding alias="null" key="To_4"/>
          <key-binding alias="null" key="From_5"/>
          <key-binding alias="null" key="To_5"/>
          <key-binding alias="null" key="From_6"/>
          <key-binding alias="null" key="To_6"/>
          <key-binding alias="null" key="From_7"/>
          <key-binding alias="null" key="To_7"/>
          <key-binding alias="null" key="From_8"/>
          <key-binding alias="null" key="To_8"/>
          <key-binding alias="null" key="From_9"/>
          <key-binding alias="null" key="To_9"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="CrossSellAuth">
    <segment>
      <node>
        <start-node name="CrossSellAuth" secure="false"/>
        <node-display x="20" y="2"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <decision-node condition-key="CurrentCustomer.authenticated" condition-operator="expr"/>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="yes">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="0" y="2"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
                <config-property key="Transactional" value="true"/>
                <config-property key="OnError" value="PIPELET_ERROR"/>
                <config-property key="ScriptFile" value="service/GetCrossSellAuths.ds"/>
                <key-binding alias="ScriptLog" key="ScriptLog"/>
                <key-binding alias="CurrentHttpParameterMap.baseurl.stringValue" key="BaseUrl"/>
                <key-binding alias="CurrentCustomer" key="CustomerProfile"/>
                <key-binding alias="CurrentCustomer" key="Customer"/>
                <key-binding alias="CrossSellLink" key="CrossSellLink"/>
                <key-binding alias="ErrorCode" key="ErrorCode"/>
                <key-binding alias="Success" key="Success"/>
              </pipelet-node>
              <node-display x="0" y="2"/>
              <branch basename="b2" source-connector="error">
                <transition target-connector="in">
                  <transition-display>
                    <bend-point relative-to="source" x="1" y="0"/>
                  </transition-display>
                </transition>
                <segment>
                  <node>
                    <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                      <config-property key="Transactional" value="false"/>
                      <key-binding alias="2" key="From_0"/>
                      <key-binding alias="ErrorCode" key="To_0"/>
                      <key-binding alias="null" key="From_1"/>
                      <key-binding alias="null" key="To_1"/>
                      <key-binding alias="null" key="From_2"/>
                      <key-binding alias="null" key="To_2"/>
                      <key-binding alias="null" key="From_3"/>
                      <key-binding alias="null" key="To_3"/>
                      <key-binding alias="null" key="From_4"/>
                      <key-binding alias="null" key="To_4"/>
                      <key-binding alias="null" key="From_5"/>
                      <key-binding alias="null" key="To_5"/>
                      <key-binding alias="null" key="From_6"/>
                      <key-binding alias="null" key="To_6"/>
                      <key-binding alias="null" key="From_7"/>
                      <key-binding alias="null" key="To_7"/>
                      <key-binding alias="null" key="From_8"/>
                      <key-binding alias="null" key="To_8"/>
                      <key-binding alias="null" key="From_9"/>
                      <key-binding alias="null" key="To_9"/>
                    </pipelet-node>
                    <node-display orientation="horizontal" x="1" y="0"/>
                  </node>
                  <transition target-connector="in3" target-path="../../+1"/>
                </segment>
              </branch>
            </node>
            <simple-transition>
              <transition-display>
                <bend-point relative-to="target" x="0" y="-1"/>
              </transition-display>
            </simple-transition>
            <node>
              <interaction-node transaction-required="false">
                <template buffered="true" dynamic="false" name="util/responsejson"/>
              </interaction-node>
              <node-display x="0" y="2"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="1" y="0"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <key-binding alias="1" key="From_0"/>
          <key-binding alias="ErrorCode" key="To_0"/>
          <key-binding alias="null" key="From_1"/>
          <key-binding alias="null" key="To_1"/>
          <key-binding alias="null" key="From_2"/>
          <key-binding alias="null" key="To_2"/>
          <key-binding alias="null" key="From_3"/>
          <key-binding alias="null" key="To_3"/>
          <key-binding alias="null" key="From_4"/>
          <key-binding alias="null" key="To_4"/>
          <key-binding alias="null" key="From_5"/>
          <key-binding alias="null" key="To_5"/>
          <key-binding alias="null" key="From_6"/>
          <key-binding alias="null" key="To_6"/>
          <key-binding alias="null" key="From_7"/>
          <key-binding alias="null" key="To_7"/>
          <key-binding alias="null" key="From_8"/>
          <key-binding alias="null" key="To_8"/>
          <key-binding alias="null" key="From_9"/>
          <key-binding alias="null" key="To_9"/>
        </pipelet-node>
        <node-display orientation="horizontal" x="1" y="0"/>
      </node>
      <transition target-connector="in1" target-path="./+1">
        <transition-display>
          <bend-point relative-to="source" x="2" y="0"/>
        </transition-display>
      </transition>
    </segment>
    <segment>
      <node>
        <join-node/>
        <node-display x="1" y="2"/>
      </node>
      <transition target-connector="in1" target-path="./+1"/>
    </segment>
    <segment>
      <node>
        <join-node/>
        <node-display x="0" y="1"/>
      </node>
      <simple-transition/>
      <node>
        <interaction-node transaction-required="false">
          <template buffered="true" dynamic="false" name="util/errorjson.isml"/>
        </interaction-node>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="Validator">
    <segment>
      <node>
        <start-node call-mode="private" name="Validator" secure="false"/>
        <node-display x="1" y="6"/>
      </node>
      <simple-transition/>
      <node>
        <call-node start-name-ref="Cart-GetExistingBasket"/>
        <node-display x="0" y="1"/>
      </node>
      <simple-transition/>
      <node>
        <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="true"/>
          <key-binding alias="!empty(CurrentCampaignConfig) ?  CurrentCampaignConfig.cartID : 1" key="From_0"/>
          <key-binding alias="Basket.custom.cartID" key="To_0"/>
          <key-binding alias="!empty(CurrentCampaignConfig) ? CurrentCampaignConfig.campaignCode : &quot;core&quot;" key="From_1"/>
          <key-binding alias="Basket.custom.campaignCode" key="To_1"/>
          <key-binding alias="!empty(CurrentCampaignConfig) ? CurrentCampaignConfig.uciCode : ''" key="From_2"/>
          <key-binding alias="Basket.custom.uciCode" key="To_2"/>
          <key-binding alias="CurrentSession.custom.rtsToken" key="From_3"/>
          <key-binding alias="Basket.custom.rtsToken" key="To_3"/>
          <key-binding alias="null" key="From_4"/>
          <key-binding alias="null" key="To_4"/>
          <key-binding alias="null" key="From_5"/>
          <key-binding alias="null" key="To_5"/>
          <key-binding alias="null" key="From_6"/>
          <key-binding alias="null" key="To_6"/>
          <key-binding alias="null" key="From_7"/>
          <key-binding alias="null" key="To_7"/>
          <key-binding alias="null" key="From_8"/>
          <key-binding alias="null" key="To_8"/>
          <key-binding alias="null" key="From_9"/>
          <key-binding alias="null" key="To_9"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
      </node>
      <simple-transition/>
      <node>
        <call-node start-name-ref="Service-GetOrderNum"/>
        <node-display x="0" y="1"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <decision-node condition-key="dw.web.Resource.msg('isvalidator_api.enabled', 'common', null) == &quot;true&quot;" condition-operator="expr"/>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="yes">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="0" y="1"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
                <config-property key="Transactional" value="false"/>
                <config-property key="OnError" value="PIPELET_ERROR"/>
                <config-property key="ScriptFile" value="guthyrenker_businesslogic:common/isRetentionProduct.ds"/>
                <key-binding alias="null" key="ScriptLog"/>
                <key-binding alias="isRetention" key="isRetention"/>
                <key-binding alias="Basket" key="basket"/>
              </pipelet-node>
              <node-display x="0" y="1"/>
              <branch basename="b2" source-connector="error">
                <transition target-connector="in1" target-path="./b4.1">
                  <transition-display>
                    <bend-point relative-to="source" x="3" y="0"/>
                    <bend-point relative-to="target" x="-1" y="0"/>
                  </transition-display>
                </transition>
              </branch>
            </node>
            <simple-transition>
              <transition-display>
                <bend-point relative-to="source" x="0" y="1"/>
              </transition-display>
            </simple-transition>
            <node>
              <decision-node condition-key="!(CurrentCustomer.authenticated) || !(isRetention)" condition-operator="expr"/>
              <node-display x="0" y="1"/>
              <branch basename="b3" source-connector="yes">
                <transition target-connector="in">
                  <transition-display>
                    <bend-point relative-to="source" x="0" y="1"/>
                  </transition-display>
                </transition>
                <segment>
                  <node>
                    <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                      <config-property key="Transactional" value="true"/>
                      <key-binding alias="&quot;nonmember&quot;" key="From_0"/>
                      <key-binding alias="Basket.custom.customerStatus" key="To_0"/>
                      <key-binding alias="null" key="From_1"/>
                      <key-binding alias="null" key="To_1"/>
                      <key-binding alias="null" key="From_2"/>
                      <key-binding alias="null" key="To_2"/>
                      <key-binding alias="null" key="From_3"/>
                      <key-binding alias="null" key="To_3"/>
                      <key-binding alias="null" key="From_4"/>
                      <key-binding alias="null" key="To_4"/>
                      <key-binding alias="null" key="From_5"/>
                      <key-binding alias="null" key="To_5"/>
                      <key-binding alias="null" key="From_6"/>
                      <key-binding alias="null" key="To_6"/>
                      <key-binding alias="null" key="From_7"/>
                      <key-binding alias="null" key="To_7"/>
                      <key-binding alias="null" key="From_8"/>
                      <key-binding alias="null" key="To_8"/>
                      <key-binding alias="null" key="From_9"/>
                      <key-binding alias="null" key="To_9"/>
                    </pipelet-node>
                    <node-display x="0" y="1"/>
                  </node>
                  <simple-transition>
                    <transition-display>
                      <bend-point relative-to="source" x="0" y="1"/>
                    </transition-display>
                  </simple-transition>
                  <node>
                    <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
                      <config-property key="Transactional" value="true"/>
                      <config-property key="OnError" value="PIPELET_ERROR"/>
                      <config-property key="ScriptFile" value="int_gutheyrenker:common/ValidateBasket.ds"/>
                      <key-binding alias="ScriptLog" key="ScriptLog"/>
                      <key-binding alias="Basket" key="Basket"/>
                      <key-binding alias="ClientOrderID" key="ClientOrderID"/>
                      <key-binding alias="ClientTransactionID" key="ClientTransactionID"/>
                      <key-binding alias="ErrorContainer" key="ErrorContainer"/>
                      <key-binding alias="PreAuthID" key="PreAuthID"/>
                      <key-binding alias="RequestURI" key="RequestURI"/>
                      <key-binding alias="ResponseID" key="ResponseID"/>
                      <key-binding alias="Status" key="Status"/>
                      <key-binding alias="ValidationID" key="ValidationID"/>
                      <key-binding alias="CurrentForms.personinf" key="CheckoutForm"/>
                      <key-binding alias="OrderNo" key="OrderNumber"/>
                      <key-binding alias="ServerError" key="ServerError"/>
                      <key-binding alias="userStatus" key="userStatus"/>
                      <key-binding alias="CurrentCampaignConfig" key="CurrentCampaignConfig"/>
                    </pipelet-node>
                    <node-display x="0" y="1"/>
                    <branch basename="b2" source-connector="error">
                      <transition target-connector="in1" target-path="../b4.1">
                        <transition-display>
                          <bend-point relative-to="target" x="-1" y="2"/>
                          <bend-point relative-to="target" x="-1" y="0"/>
                        </transition-display>
                      </transition>
                    </branch>
                  </node>
                  <transition target-connector="in1" target-path="../+1"/>
                </segment>
              </branch>
            </node>
            <simple-transition>
              <transition-display>
                <bend-point relative-to="source" x="1" y="0"/>
              </transition-display>
            </simple-transition>
            <node>
              <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                <config-property key="Transactional" value="true"/>
                <key-binding alias="dw.web.Resource.msg('retention.cartid', 'common', null)" key="From_0"/>
                <key-binding alias="Basket.custom.cartID" key="To_0"/>
                <key-binding alias="CurrentCustomer.profile.custom.customerSegment" key="From_2"/>
                <key-binding alias="Basket.custom.customerStatusCode" key="To_3"/>
                <key-binding alias="Basket.custom.ffcTransactionId" key="To_4"/>
                <key-binding alias="Basket.custom.grcOrderId" key="To_5"/>
                <key-binding alias="CurrentCustomer.profile.custom.mwid" key="From_6"/>
                <key-binding alias="Basket.custom.mwid" key="To_6"/>
                <key-binding alias="null" key="From_7"/>
                <key-binding alias="null" key="To_7"/>
                <key-binding alias="null" key="From_8"/>
                <key-binding alias="null" key="To_8"/>
                <key-binding alias="null" key="From_9"/>
                <key-binding alias="null" key="To_9"/>
                <key-binding alias="CurrentCustomer.profile.custom.customerStatus" key="From_1"/>
                <key-binding alias="Basket.custom.customerStatus" key="To_1"/>
                <key-binding alias="Basket.custom.customerSegment" key="To_2"/>
                <key-binding alias="CurrentSession.custom.customerStatusCode" key="From_3"/>
                <key-binding alias="CurrentCustomer.profile.custom.ffcTransactionId" key="From_4"/>
                <key-binding alias="CurrentCustomer.profile.custom.ffcOrderId" key="From_5"/>
              </pipelet-node>
              <node-display orientation="horizontal" x="1" y="0"/>
            </node>
            <simple-transition>
              <transition-display>
                <bend-point relative-to="source" x="1" y="0"/>
              </transition-display>
            </simple-transition>
            <node>
              <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
                <config-property key="Transactional" value="true"/>
                <config-property key="OnError" value="PIPELET_ERROR"/>
                <config-property key="ScriptFile" value="common/ValidateBasketRetention.ds"/>
                <key-binding alias="ScriptLog" key="ScriptLog"/>
                <key-binding alias="Basket" key="Basket"/>
                <key-binding alias="CurrentForms.billing" key="billing"/>
                <key-binding alias="CurrentForms.singleshipping" key="singleshipping"/>
                <key-binding alias="OrderNo" key="OrderNumber"/>
                <key-binding alias="ClientOrderID" key="ClientOrderID"/>
                <key-binding alias="ClientTransactionID" key="ClientTransactionID"/>
                <key-binding alias="ErrorContainer" key="ErrorContainer"/>
                <key-binding alias="PreAuthID" key="PreAuthID"/>
                <key-binding alias="RequestURI" key="RequestURI"/>
                <key-binding alias="ResponseID" key="ResponseID"/>
                <key-binding alias="ServerError" key="ServerError"/>
                <key-binding alias="Status" key="Status"/>
                <key-binding alias="ValidationID" key="ValidationID"/>
                <key-binding alias="ShippingError" key="ShippingError"/>
                <key-binding alias="BillingError" key="BillingError"/>
                <key-binding alias="PaymentError" key="PaymentError"/>
                <key-binding alias="ErrorSections" key="ErrorSections"/>
              </pipelet-node>
              <node-display orientation="horizontal" x="1" y="0"/>
              <branch basename="b4" source-connector="error">
                <transition target-connector="in1"/>
                <segment>
                  <node>
                    <join-node/>
                    <node-display x="0" y="1"/>
                  </node>
                  <simple-transition>
                    <transition-display>
                      <bend-point relative-to="source" x="0" y="1"/>
                    </transition-display>
                  </simple-transition>
                  <node>
                    <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                      <config-property key="Transactional" value="false"/>
                      <key-binding alias="null" key="From_0"/>
                      <key-binding alias="CurrentSession.privacy.OrderNo" key="To_0"/>
                      <key-binding alias="null" key="From_1"/>
                      <key-binding alias="OrderNo" key="To_1"/>
                      <key-binding alias="null" key="From_2"/>
                      <key-binding alias="CurrentSession.privacy.OrderNoDec" key="To_2"/>
                      <key-binding alias="null" key="From_3"/>
                      <key-binding alias="null" key="To_3"/>
                      <key-binding alias="null" key="From_4"/>
                      <key-binding alias="null" key="To_4"/>
                      <key-binding alias="null" key="From_5"/>
                      <key-binding alias="null" key="To_5"/>
                      <key-binding alias="null" key="From_6"/>
                      <key-binding alias="null" key="To_6"/>
                      <key-binding alias="null" key="From_7"/>
                      <key-binding alias="null" key="To_7"/>
                      <key-binding alias="null" key="From_8"/>
                      <key-binding alias="null" key="To_8"/>
                      <key-binding alias="null" key="From_9"/>
                      <key-binding alias="null" key="To_9"/>
                    </pipelet-node>
                    <node-display x="0" y="1"/>
                  </node>
                  <simple-transition>
                    <transition-display>
                      <bend-point relative-to="target" x="0" y="-1"/>
                    </transition-display>
                  </simple-transition>
                  <node>
                    <decision-node condition-key="ServerError == true" condition-operator="expr"/>
                    <node-display x="0" y="2"/>
                    <branch basename="b2" source-connector="yes">
                      <transition target-connector="in">
                        <transition-display>
                          <bend-point relative-to="source" x="0" y="1"/>
                        </transition-display>
                      </transition>
                      <segment>
                        <node>
                          <call-node start-name-ref="Service-CopyValidatorInfo"/>
                          <node-display x="0" y="1"/>
                        </node>
                        <simple-transition>
                          <transition-display>
                            <bend-point relative-to="source" x="0" y="1"/>
                          </transition-display>
                        </simple-transition>
                        <node>
                          <end-node name="error"/>
                          <node-display x="0" y="1"/>
                        </node>
                      </segment>
                    </branch>
                  </node>
                  <simple-transition>
                    <transition-display>
                      <bend-point relative-to="source" x="1" y="0"/>
                    </transition-display>
                  </simple-transition>
                  <node>
                    <end-node name="invalid"/>
                    <node-display orientation="horizontal" x="1" y="0"/>
                  </node>
                </segment>
              </branch>
            </node>
            <transition target-connector="in1" target-path="./+1">
              <transition-display>
                <bend-point relative-to="source" x="2" y="0"/>
                <bend-point relative-to="source" x="2" y="2"/>
                <bend-point relative-to="target" x="6" y="0"/>
              </transition-display>
            </transition>
          </segment>
          <segment>
            <node>
              <join-node/>
              <node-display x="-2" y="3"/>
            </node>
            <simple-transition>
              <transition-display>
                <bend-point relative-to="source" x="0" y="1"/>
              </transition-display>
            </simple-transition>
            <node>
              <call-node start-name-ref="Service-CopyValidatorInfo"/>
              <node-display x="0" y="1"/>
            </node>
            <transition target-connector="in1" target-path="../+1"/>
          </segment>
        </branch>
      </node>
      <transition target-connector="in1" target-path="./+1">
        <transition-display>
          <bend-point relative-to="source" x="1" y="0"/>
          <bend-point relative-to="source" x="1" y="1"/>
          <bend-point relative-to="source" x="-1" y="1"/>
          <bend-point relative-to="source" x="-1" y="2"/>
          <bend-point relative-to="target" x="-1" y="0"/>
        </transition-display>
      </transition>
    </segment>
    <segment>
      <node>
        <join-node/>
        <node-display x="0" y="7"/>
      </node>
      <simple-transition/>
      <node>
        <end-node name="ok"/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="TestValidator">
    <segment>
      <node>
        <start-node name="TestValidator" secure="false"/>
        <node-display x="5" y="6"/>
      </node>
      <simple-transition/>
      <node>
        <call-node start-name-ref="Cart-GetBasket"/>
        <node-display x="0" y="1"/>
      </node>
      <simple-transition/>
      <node>
        <call-node start-name-ref="Service-Validator"/>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="target" x="-1" y="0"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <interaction-node transaction-required="false">
                <template buffered="true" dynamic="false" name="util/validatorresponse"/>
              </interaction-node>
              <node-display orientation="horizontal" x="1" y="1"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="target" x="0" y="-1"/>
        </transition-display>
      </simple-transition>
      <node>
        <interaction-node transaction-required="false">
          <template buffered="true" dynamic="false" name="util/validatorresponse"/>
        </interaction-node>
        <node-display x="0" y="2"/>
      </node>
    </segment>
  </branch>
  <branch basename="_ANONYMOUS_BRANCH_14">
    <segment>
      <node>
        <text-node>
          <description>Here one more check would be implemented , which will contain the status = 1A</description>
        </text-node>
        <node-display x="11" y="7"/>
      </node>
    </segment>
  </branch>
  <branch basename="_ANONYMOUS_BRANCH_15">
    <segment>
      <node>
        <text-node>
          <description>Instant Access Flag</description>
        </text-node>
        <node-display x="11" y="8"/>
      </node>
    </segment>
  </branch>
  <branch basename="ShippingFreqForDT">
    <segment>
      <node>
        <start-node call-mode="private" name="ShippingFreqForDT" secure="false"/>
        <node-display x="10" y="11"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="grmiddleware/ShippingFrequency.ds"/>
          <key-binding alias="log" key="ScriptLog"/>
          <key-binding alias="CurrentSession.sessionID" key="CurrentSessionId"/>
          <key-binding alias="CurrentRequest.httpRemoteAddress" key="ipAddress"/>
          <key-binding alias="&quot;1&quot;" key="cartId"/>
          <key-binding alias="dw.system.Site.current.getCustomPreferenceValue(&quot;GRMProductLine&quot;)" key="brandId"/>
          <key-binding alias="&quot;12233445514&quot;" key="transactionID"/>
          <key-binding alias="&quot;VHgNyZ&quot;" key="uid"/>
          <key-binding alias="stausMsg" key="statusMessage"/>
          <key-binding alias="errorCode" key="ErrorContainer"/>
          <key-binding alias="weeks" key="weeksBetweenShipments"/>
          <key-binding alias="CurrentCustomerObj.profile.custom.accountNumber" key="account"/>
          <key-binding alias="CurrentSession.sessionID" key="currentSessionId"/>
          <key-binding alias="CurrentRequest" key="Request"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="2" y="0"/>
              <bend-point relative-to="target" x="0" y="-1"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <end-node name="error"/>
              <node-display x="1" y="1"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node name="success"/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="ShippingFreq">
    <segment>
      <node>
        <start-node call-mode="private" name="ShippingFreq" secure="false"/>
        <node-display x="12" y="11"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="grmiddleware/ShippingFrequency.ds"/>
          <key-binding alias="log" key="ScriptLog"/>
          <key-binding alias="CurrentSession.sessionID" key="CurrentSessionId"/>
          <key-binding alias="CurrentRequest.httpRemoteAddress" key="ipAddress"/>
          <key-binding alias="&quot;1&quot;" key="cartId"/>
          <key-binding alias="dw.system.Site.current.getCustomPreferenceValue(&quot;GRMProductLine&quot;)" key="brandId"/>
          <key-binding alias="&quot;12233445514&quot;" key="transactionID"/>
          <key-binding alias="&quot;VHgNyZ&quot;" key="uid"/>
          <key-binding alias="stausMsg" key="statusMessage"/>
          <key-binding alias="errorCode" key="ErrorContainer"/>
          <key-binding alias="weeks" key="weeksBetweenShipments"/>
          <key-binding alias="CurrentCustomer.profile.custom.accountNumber" key="account"/>
          <key-binding alias="CurrentSession.sessionID" key="currentSessionId"/>
          <key-binding alias="CurrentRequest" key="Request"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="2" y="0"/>
              <bend-point relative-to="target" x="0" y="-1"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <end-node name="error"/>
              <node-display x="1" y="1"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node name="success"/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="RTSCheck">
    <segment>
      <node>
        <start-node call-mode="private" name="RTSCheck" secure="false"/>
        <node-display x="19" y="8"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="service/GetRTS.ds"/>
          <key-binding alias="log" key="ScriptLog"/>
          <key-binding alias="responseXML" key="responseXMLObject"/>
          <key-binding alias="CurrentForms.Personinf" key="PersonInfForm"/>
          <key-binding alias="Basket.custom.CartID" key="cartId"/>
          <key-binding alias="CurrentHttpParameterMap" key="CurrentHttpParameterMap"/>
          <key-binding alias="CurrentRequest" key="Request"/>
          <key-binding alias="CurrentSession.sessionID" key="sessionId"/>
          <key-binding alias="CurrentRequest.httpRemoteAddress" key="remoteIP"/>
          <key-binding alias="errorCode_Array" key="errorCodes"/>
          <key-binding alias="errorString_Array" key="errorStrings"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="2" y="0"/>
              <bend-point relative-to="target" x="0" y="-1"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <end-node name="error"/>
              <node-display x="1" y="1"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node name="success"/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="SendKitData">
    <segment>
      <node>
        <start-node call-mode="private" name="SendKitData" secure="false"/>
        <node-display x="16" y="11"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <decision-node condition-key="empty(co)" condition-operator="expr"/>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="yes">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="0" y="1"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                <config-property key="Transactional" value="false"/>
                <key-binding alias="sessionID" key="To_0"/>
                <key-binding alias="CurrentRequest.httpRemoteAddress" key="From_1"/>
                <key-binding alias="IPAddress" key="To_1"/>
                <key-binding alias="null" key="From_2"/>
                <key-binding alias="null" key="To_2"/>
                <key-binding alias="null" key="From_3"/>
                <key-binding alias="null" key="To_3"/>
                <key-binding alias="null" key="From_4"/>
                <key-binding alias="null" key="To_4"/>
                <key-binding alias="null" key="From_5"/>
                <key-binding alias="null" key="To_5"/>
                <key-binding alias="null" key="From_6"/>
                <key-binding alias="null" key="To_6"/>
                <key-binding alias="null" key="From_7"/>
                <key-binding alias="null" key="To_7"/>
                <key-binding alias="null" key="From_8"/>
                <key-binding alias="null" key="To_8"/>
                <key-binding alias="null" key="From_9"/>
                <key-binding alias="null" key="To_9"/>
                <key-binding alias="CurrentSession.sessionID" key="From_0"/>
              </pipelet-node>
              <node-display x="0" y="1"/>
            </node>
            <transition target-connector="in1" target-path="../+1"/>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="2" y="0"/>
          <bend-point relative-to="target" x="0" y="-1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <key-binding alias="sessionID" key="To_0"/>
          <key-binding alias="co.custom.IPAddress" key="From_1"/>
          <key-binding alias="IPAddress" key="To_1"/>
          <key-binding alias="null" key="From_2"/>
          <key-binding alias="null" key="To_2"/>
          <key-binding alias="null" key="From_3"/>
          <key-binding alias="null" key="To_3"/>
          <key-binding alias="null" key="From_4"/>
          <key-binding alias="null" key="To_4"/>
          <key-binding alias="null" key="From_5"/>
          <key-binding alias="null" key="To_5"/>
          <key-binding alias="null" key="From_6"/>
          <key-binding alias="null" key="To_6"/>
          <key-binding alias="null" key="From_7"/>
          <key-binding alias="null" key="To_7"/>
          <key-binding alias="null" key="From_8"/>
          <key-binding alias="null" key="To_8"/>
          <key-binding alias="null" key="From_9"/>
          <key-binding alias="null" key="To_9"/>
          <key-binding alias="co.custom.sessionID" key="From_0"/>
        </pipelet-node>
        <node-display x="1" y="1"/>
      </node>
      <transition target-connector="in1" target-path="./+1">
        <transition-display>
          <bend-point relative-to="source" x="0" y="2"/>
        </transition-display>
      </transition>
    </segment>
    <segment>
      <node>
        <join-node/>
        <node-display x="-1" y="1"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="service/SaveKit.ds"/>
          <key-binding alias="savekitLog" key="ScriptLog"/>
          <key-binding alias="kitUpdated" key="kitupdated"/>
          <key-binding alias="IPAddress" key="ipAddress"/>
          <key-binding alias="CurrentRequest" key="Request"/>
          <key-binding alias="mwid" key="mwid"/>
          <key-binding alias="upcArray" key="products"/>
          <key-binding alias="sessionID" key="sessionId"/>
          <key-binding alias="status" key="status"/>
          <key-binding alias="customerSegment" key="customerSegment"/>
          <key-binding alias="Customer" key="customer"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in1" target-path="./+1">
            <transition-display>
              <bend-point relative-to="source" x="2" y="0"/>
            </transition-display>
          </transition>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <decision-node condition-key="status == &quot;200&quot;" condition-operator="expr"/>
        <node-display x="0" y="1"/>
        <branch basename="b3" source-connector="yes">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="0" y="1"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <end-node name="success"/>
              <node-display x="0" y="1"/>
            </node>
          </segment>
        </branch>
      </node>
      <transition target-connector="in1" target-path="./+1"/>
    </segment>
    <segment>
      <node>
        <join-node/>
        <node-display x="1" y="0"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node name="error"/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="GetOrderNum">
    <segment>
      <node>
        <start-node call-mode="private" name="GetOrderNum" secure="false"/>
        <node-display x="6" y="12"/>
      </node>
      <simple-transition/>
      <node>
        <decision-node condition-key="empty(CurrentSession.privacy.OrderNo)" condition-operator="expr"/>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="yes">
          <transition target-connector="in"/>
          <segment>
            <node>
              <pipelet-node pipelet-name="CreateOrderNo" pipelet-set-identifier="bc_api">
                <key-binding alias="OrderNoDec" key="OrderNo"/>
              </pipelet-node>
              <node-display x="0" y="1"/>
            </node>
            <simple-transition/>
            <node>
              <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
                <config-property key="Transactional" value="false"/>
                <config-property key="OnError" value="PIPELET_ERROR"/>
                <config-property key="ScriptFile" value="guthyrenker_businesslogic:checkout/GenerateOrderNoInHexFormat.ds"/>
                <key-binding alias="null" key="ScriptLog"/>
                <key-binding alias="7" key="CountOfDigitsInOrderNo"/>
                <key-binding alias="OrderNoDec" key="OrderNoDec"/>
                <key-binding alias="OrderNo" key="OrderNoHex"/>
                <key-binding alias="dw.system.Site.getCurrent().getCustomPreferenceValue(&quot;orderNoPrefix&quot;)" key="OrderNoPrefix"/>
              </pipelet-node>
              <node-display x="0" y="1"/>
              <branch basename="b2" source-connector="error">
                <transition target-connector="in1"/>
                <segment>
                  <node>
                    <join-node/>
                    <node-display x="1" y="0"/>
                  </node>
                  <simple-transition/>
                  <node>
                    <end-node name="error"/>
                    <node-display orientation="horizontal" x="1" y="0"/>
                  </node>
                </segment>
              </branch>
            </node>
            <simple-transition>
              <transition-display>
                <bend-point relative-to="source" x="0" y="1"/>
              </transition-display>
            </simple-transition>
            <node>
              <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                <config-property key="Transactional" value="false"/>
                <key-binding alias="OrderNo" key="From_0"/>
                <key-binding alias="CurrentSession.privacy.OrderNo" key="To_0"/>
                <key-binding alias="OrderNoDec" key="From_1"/>
                <key-binding alias="CurrentSession.privacy.OrderNoDec" key="To_1"/>
                <key-binding alias="null" key="From_2"/>
                <key-binding alias="null" key="To_2"/>
                <key-binding alias="null" key="From_3"/>
                <key-binding alias="null" key="To_3"/>
                <key-binding alias="null" key="From_4"/>
                <key-binding alias="null" key="To_4"/>
                <key-binding alias="null" key="From_5"/>
                <key-binding alias="null" key="To_5"/>
                <key-binding alias="null" key="From_6"/>
                <key-binding alias="null" key="To_6"/>
                <key-binding alias="null" key="From_7"/>
                <key-binding alias="null" key="To_7"/>
                <key-binding alias="null" key="From_8"/>
                <key-binding alias="null" key="To_8"/>
                <key-binding alias="null" key="From_9"/>
                <key-binding alias="null" key="To_9"/>
              </pipelet-node>
              <node-display x="0" y="1"/>
            </node>
            <simple-transition>
              <transition-display>
                <bend-point relative-to="source" x="0" y="1"/>
              </transition-display>
            </simple-transition>
            <node>
              <end-node/>
              <node-display x="0" y="1"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition/>
      <node>
        <decision-node condition-key="!empty(OrderNo)" condition-operator="expr"/>
        <node-display orientation="horizontal" x="1" y="0"/>
        <branch basename="b3" source-connector="yes">
          <transition target-connector="in"/>
          <segment>
            <node>
              <end-node/>
              <node-display orientation="horizontal" x="1" y="0"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <key-binding alias="CurrentSession.privacy.OrderNo" key="From_0"/>
          <key-binding alias="OrderNo" key="To_0"/>
          <key-binding alias="CurrentSession.privacy.OrderNoDec" key="From_1"/>
          <key-binding alias="OrderNoDec" key="To_1"/>
          <key-binding alias="null" key="From_2"/>
          <key-binding alias="null" key="To_2"/>
          <key-binding alias="null" key="From_3"/>
          <key-binding alias="null" key="To_3"/>
          <key-binding alias="null" key="From_4"/>
          <key-binding alias="null" key="To_4"/>
          <key-binding alias="null" key="From_5"/>
          <key-binding alias="null" key="To_5"/>
          <key-binding alias="null" key="From_6"/>
          <key-binding alias="null" key="To_6"/>
          <key-binding alias="null" key="From_7"/>
          <key-binding alias="null" key="To_7"/>
          <key-binding alias="null" key="From_8"/>
          <key-binding alias="null" key="To_8"/>
          <key-binding alias="null" key="From_9"/>
          <key-binding alias="null" key="To_9"/>
        </pipelet-node>
        <node-display orientation="horizontal" x="0" y="1"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="1" y="0"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node/>
        <node-display orientation="horizontal" x="1" y="0"/>
      </node>
    </segment>
  </branch>
  <branch basename="_ANONYMOUS_BRANCH_21">
    <segment>
      <node>
        <text-node>
          <description>Flow to be called during change of the account number and fetching whole information from MW API and saving it in the BM.</description>
        </text-node>
        <node-display x="12" y="15"/>
      </node>
    </segment>
  </branch>
  <branch basename="PreValidateUID">
    <segment>
      <node>
        <start-node name="PreValidateUID" secure="false"/>
        <node-display x="0" y="18"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <call-node start-name-ref="Campaign-GetCurrentFromRequest"/>
        <node-display x="0" y="1"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <key-binding alias="CurrentCampaignConfig.getDefaultCoreOffer()" key="From_0"/>
          <key-binding alias="Product" key="To_0"/>
          <key-binding alias="null" key="From_1"/>
          <key-binding alias="null" key="To_1"/>
          <key-binding alias="null" key="From_2"/>
          <key-binding alias="null" key="To_2"/>
          <key-binding alias="null" key="From_3"/>
          <key-binding alias="null" key="To_3"/>
          <key-binding alias="null" key="From_4"/>
          <key-binding alias="null" key="To_4"/>
          <key-binding alias="null" key="From_5"/>
          <key-binding alias="null" key="To_5"/>
          <key-binding alias="null" key="From_6"/>
          <key-binding alias="null" key="To_6"/>
          <key-binding alias="null" key="From_7"/>
          <key-binding alias="null" key="To_7"/>
          <key-binding alias="null" key="From_8"/>
          <key-binding alias="null" key="To_8"/>
          <key-binding alias="null" key="From_9"/>
          <key-binding alias="null" key="To_9"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <call-node start-name-ref="Service-ValidateUID"/>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="unauthorized">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="target" x="-1" y="0"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <interaction-node transaction-required="false">
                <template buffered="true" dynamic="false" name="common/jsonfailure"/>
              </interaction-node>
              <node-display orientation="horizontal" x="1" y="1"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <interaction-node transaction-required="false">
          <template buffered="true" dynamic="false" name="common/jsonresult.isml"/>
        </interaction-node>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="_ANONYMOUS_BRANCH_23">
    <segment>
      <node>
        <text-node>
          <description>Validates a ukey, from a Print Media Campaign Landing Page.

May return error.</description>
        </text-node>
        <node-display x="1" y="19"/>
      </node>
    </segment>
  </branch>
  <branch basename="VCIFetchCustomer">
    <segment>
      <node>
        <start-node call-mode="private" name="VCIFetchCustomer" secure="false"/>
        <node-display x="12" y="16"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="service/VCIGetCustomer.ds"/>
          <key-binding alias="log" key="ScriptLog"/>
          <key-binding alias="CurrentForms.login.username.value" key="Login"/>
          <key-binding alias="CurrentForms.login.password.value" key="Password"/>
          <key-binding alias="loginAuthenticated" key="loginstatus"/>
          <key-binding alias="changepassword" key="changepassword"/>
          <key-binding alias="accountstatus" key="accountstatus"/>
          <key-binding alias="profile" key="profile"/>
          <key-binding alias="CurrentCustomer" key="CurrentCustomer"/>
          <key-binding alias="CurrentForms.profile" key="ProfileForm"/>
          <key-binding alias="CustomerObj.profile.email" key="emailId"/>
          <key-binding alias="CurrentForms.login.password.value" key="password"/>
          <key-binding alias="CurrentSession.sessionID" key="sessionId"/>
          <key-binding alias="CurrentRequest.getHttpRemoteAddress()" key="remoteIP"/>
          <key-binding alias="responseXML" key="responseXMLObject"/>
          <key-binding alias="loginAuthenticated" key="loginAuthenticated"/>
          <key-binding alias="dw.system.Site.current.getCustomPreferenceValue(&quot;GRMProductLine&quot;)" key="brand"/>
          <key-binding alias="mwId" key="mwid"/>
          <key-binding alias="&quot;true&quot;" key="searchall"/>
          <key-binding alias="&quot;123456789&quot;" key="trans"/>
          <key-binding alias="&quot;VHgNyZ&quot;" key="uid"/>
          <key-binding alias="CurrentRequest.httpRemoteAddress" key="ipAddress"/>
          <key-binding alias="CurrentRequest" key="Request"/>
          <key-binding alias="status" key="status"/>
          <key-binding alias="emailID" key="email"/>
          <key-binding alias="CustomerSegment" key="CustomerSegment"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in"/>
          <segment>
            <node>
              <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                <config-property key="Transactional" value="false"/>
                <key-binding alias="dw.web.Resource.msg(&quot;mw.login.errormessage2&quot;)" key="From_0"/>
                <key-binding alias="null" key="From_1"/>
                <key-binding alias="null" key="To_1"/>
                <key-binding alias="null" key="From_2"/>
                <key-binding alias="null" key="To_2"/>
                <key-binding alias="null" key="From_3"/>
                <key-binding alias="null" key="To_3"/>
                <key-binding alias="null" key="From_4"/>
                <key-binding alias="null" key="To_4"/>
                <key-binding alias="null" key="From_5"/>
                <key-binding alias="null" key="To_5"/>
                <key-binding alias="null" key="From_6"/>
                <key-binding alias="null" key="To_6"/>
                <key-binding alias="null" key="From_7"/>
                <key-binding alias="null" key="To_7"/>
                <key-binding alias="null" key="From_8"/>
                <key-binding alias="null" key="To_8"/>
                <key-binding alias="null" key="From_9"/>
                <key-binding alias="null" key="To_9"/>
                <key-binding alias="login_error_message" key="To_0"/>
              </pipelet-node>
              <node-display orientation="horizontal" x="1" y="0"/>
            </node>
            <simple-transition/>
            <node>
              <end-node name="fail"/>
              <node-display orientation="horizontal" x="1" y="0"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition/>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="service/GetCustomerBrand.ds"/>
          <key-binding alias="null" key="ScriptLog"/>
          <key-binding alias="CustomerSegment" key="Segment"/>
          <key-binding alias="CustomerBrand" key="CustomerBrand"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b3" source-connector="error">
          <transition target-connector="in2" target-path="./+1"/>
        </branch>
      </node>
      <transition target-connector="in1" target-path="./+1"/>
    </segment>
    <segment>
      <node>
        <join-node/>
        <node-display x="0" y="1"/>
      </node>
      <simple-transition/>
      <node>
        <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <key-binding alias="dw.web.Resource.msg(&quot;mw.login.successmessage&quot;)" key="From_0"/>
          <key-binding alias="login_error_message" key="To_0"/>
          <key-binding alias="null" key="From_1"/>
          <key-binding alias="null" key="To_1"/>
          <key-binding alias="null" key="From_2"/>
          <key-binding alias="null" key="To_2"/>
          <key-binding alias="null" key="From_3"/>
          <key-binding alias="null" key="To_3"/>
          <key-binding alias="null" key="From_4"/>
          <key-binding alias="null" key="To_4"/>
          <key-binding alias="null" key="From_5"/>
          <key-binding alias="null" key="To_5"/>
          <key-binding alias="null" key="From_6"/>
          <key-binding alias="null" key="To_6"/>
          <key-binding alias="null" key="From_7"/>
          <key-binding alias="null" key="To_7"/>
          <key-binding alias="null" key="From_8"/>
          <key-binding alias="null" key="To_8"/>
          <key-binding alias="null" key="From_9"/>
          <key-binding alias="null" key="To_9"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node name="success"/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="AutoLogin">
    <segment>
      <node>
        <start-node call-mode="private" name="AutoLogin" secure="false"/>
        <node-display x="14" y="19"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="guthyrenker_businesslogic:AutoLoginGetCustomer.ds"/>
          <key-binding alias="log" key="ScriptLog"/>
          <key-binding alias="autoLoginResponseXML" key="responseXMLObject"/>
          <key-binding alias="CurrentHttpParameterMap.h.stringValue" key="hashKey"/>
          <key-binding alias="email" key="email"/>
          <key-binding alias="CurrentSession.sessionID" key="sessionId"/>
          <key-binding alias="CurrentRequest" key="Request"/>
          <key-binding alias="CurrentRequest.httpRemoteAddress" key="ipAddress"/>
          <key-binding alias="&quot;true&quot;" key="details"/>
          <key-binding alias="mwId" key="mwId"/>
          <key-binding alias="status" key="status"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="1" y="0"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                <config-property key="Transactional" value="false"/>
                <key-binding alias="dw.web.Resource.msg(&quot;mw.login.errormessage2&quot;)" key="From_0"/>
                <key-binding alias="login_error_message" key="To_0"/>
                <key-binding alias="null" key="From_1"/>
                <key-binding alias="null" key="To_1"/>
                <key-binding alias="null" key="From_2"/>
                <key-binding alias="null" key="To_2"/>
                <key-binding alias="null" key="From_3"/>
                <key-binding alias="null" key="To_3"/>
                <key-binding alias="null" key="From_4"/>
                <key-binding alias="null" key="To_4"/>
                <key-binding alias="null" key="From_5"/>
                <key-binding alias="null" key="To_5"/>
                <key-binding alias="null" key="From_6"/>
                <key-binding alias="null" key="To_6"/>
                <key-binding alias="null" key="From_7"/>
                <key-binding alias="null" key="To_7"/>
                <key-binding alias="null" key="From_8"/>
                <key-binding alias="null" key="To_8"/>
                <key-binding alias="null" key="From_9"/>
                <key-binding alias="null" key="To_9"/>
              </pipelet-node>
              <node-display orientation="horizontal" x="1" y="0"/>
            </node>
            <simple-transition>
              <transition-display>
                <bend-point relative-to="source" x="1" y="0"/>
              </transition-display>
            </simple-transition>
            <node>
              <end-node name="Fail"/>
              <node-display orientation="horizontal" x="1" y="0"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <key-binding alias="dw.web.Resource.msg(&quot;mw.login.successmessage&quot;)" key="From_0"/>
          <key-binding alias="login_error_message" key="To_0"/>
          <key-binding alias="null" key="From_2"/>
          <key-binding alias="null" key="To_2"/>
          <key-binding alias="null" key="From_3"/>
          <key-binding alias="null" key="To_3"/>
          <key-binding alias="null" key="From_4"/>
          <key-binding alias="null" key="To_4"/>
          <key-binding alias="null" key="From_5"/>
          <key-binding alias="null" key="To_5"/>
          <key-binding alias="null" key="From_6"/>
          <key-binding alias="null" key="To_6"/>
          <key-binding alias="null" key="From_7"/>
          <key-binding alias="null" key="To_7"/>
          <key-binding alias="null" key="From_8"/>
          <key-binding alias="null" key="To_8"/>
          <key-binding alias="null" key="From_9"/>
          <key-binding alias="null" key="To_9"/>
          <key-binding alias="email" key="From_1"/>
          <key-binding alias="emailID" key="To_1"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node name="Success"/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="ValidateUID">
    <segment>
      <node>
        <start-node call-mode="private" name="ValidateUID" secure="false"/>
        <node-display x="1" y="20"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
          <bend-point relative-to="source" x="-1" y="1"/>
          <bend-point relative-to="target" x="-1" y="0"/>
        </transition-display>
      </simple-transition>
      <node>
        <call-node start-name-ref="Campaign-GetCurrentFromRequest"/>
        <node-display orientation="horizontal" x="0" y="1"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="1" y="0"/>
        </transition-display>
      </simple-transition>
      <node>
        <decision-node condition-key="empty(CurrentHttpParameterMap.ukey.stringValue)" condition-operator="expr"/>
        <node-display orientation="horizontal" x="1" y="0"/>
        <branch basename="b2" source-connector="yes">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="1" y="0"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <decision-node condition-key="empty(CurrentHttpParameterMap.auth.stringValue)" condition-operator="expr"/>
              <node-display orientation="horizontal" x="1" y="0"/>
              <branch basename="b2" source-connector="yes">
                <transition target-connector="in">
                  <transition-display>
                    <bend-point relative-to="source" x="1" y="0"/>
                  </transition-display>
                </transition>
                <segment>
                  <node>
                    <decision-node condition-key="empty(CurrentHttpParameterMap.authkey.stringValue)" condition-operator="expr"/>
                    <node-display orientation="horizontal" x="1" y="0"/>
                    <branch basename="b2" source-connector="yes">
                      <transition target-connector="in">
                        <transition-display>
                          <bend-point relative-to="source" x="1" y="0"/>
                        </transition-display>
                      </transition>
                      <segment>
                        <node>
                          <decision-node condition-key="empty(CurrentForms.personinf.ukey) || empty(CurrentForms.personinf.ukey.value)" condition-operator="expr"/>
                          <node-display orientation="horizontal" x="1" y="0"/>
                          <branch basename="b2" source-connector="yes">
                            <transition target-connector="in1" target-path="../+1">
                              <transition-display>
                                <bend-point relative-to="source" x="1" y="0"/>
                                <bend-point relative-to="target" x="3" y="0"/>
                              </transition-display>
                            </transition>
                          </branch>
                        </node>
                        <simple-transition/>
                        <node>
                          <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                            <config-property key="Transactional" value="false"/>
                            <key-binding alias="CurrentForms.personinf.ukey.value" key="From_0"/>
                            <key-binding alias="CurrentSession.custom.ukey" key="To_0"/>
                            <key-binding alias="null" key="From_1"/>
                            <key-binding alias="null" key="To_1"/>
                            <key-binding alias="null" key="From_2"/>
                            <key-binding alias="null" key="To_2"/>
                            <key-binding alias="null" key="From_3"/>
                            <key-binding alias="null" key="To_3"/>
                            <key-binding alias="null" key="From_4"/>
                            <key-binding alias="null" key="To_4"/>
                            <key-binding alias="null" key="From_5"/>
                            <key-binding alias="null" key="To_5"/>
                            <key-binding alias="null" key="From_6"/>
                            <key-binding alias="null" key="To_6"/>
                            <key-binding alias="null" key="From_7"/>
                            <key-binding alias="null" key="To_7"/>
                            <key-binding alias="null" key="From_8"/>
                            <key-binding alias="null" key="To_8"/>
                            <key-binding alias="null" key="From_9"/>
                            <key-binding alias="null" key="To_9"/>
                          </pipelet-node>
                          <node-display x="0" y="1"/>
                        </node>
                        <transition target-connector="in1" target-path="../+1">
                          <transition-display>
                            <bend-point relative-to="source" x="0" y="2"/>
                          </transition-display>
                        </transition>
                      </segment>
                    </branch>
                  </node>
                  <simple-transition/>
                  <node>
                    <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                      <config-property key="Transactional" value="false"/>
                      <key-binding alias="CurrentHttpParameterMap.authkey.stringValue" key="From_0"/>
                      <key-binding alias="CurrentSession.custom.ukey" key="To_0"/>
                      <key-binding alias="null" key="From_1"/>
                      <key-binding alias="null" key="To_1"/>
                      <key-binding alias="null" key="From_2"/>
                      <key-binding alias="null" key="To_2"/>
                      <key-binding alias="null" key="From_3"/>
                      <key-binding alias="null" key="To_3"/>
                      <key-binding alias="null" key="From_4"/>
                      <key-binding alias="null" key="To_4"/>
                      <key-binding alias="null" key="From_5"/>
                      <key-binding alias="null" key="To_5"/>
                      <key-binding alias="null" key="From_6"/>
                      <key-binding alias="null" key="To_6"/>
                      <key-binding alias="null" key="From_7"/>
                      <key-binding alias="null" key="To_7"/>
                      <key-binding alias="null" key="From_8"/>
                      <key-binding alias="null" key="To_8"/>
                      <key-binding alias="null" key="From_9"/>
                      <key-binding alias="null" key="To_9"/>
                    </pipelet-node>
                    <node-display x="0" y="1"/>
                  </node>
                  <transition target-connector="in1" target-path="./+1"/>
                </segment>
                <segment>
                  <node>
                    <join-node/>
                    <node-display x="0" y="1"/>
                  </node>
                  <transition target-connector="in3" target-path="../+1"/>
                </segment>
              </branch>
            </node>
            <simple-transition/>
            <node>
              <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                <config-property key="Transactional" value="false"/>
                <key-binding alias="CurrentHttpParameterMap.auth.stringValue" key="From_0"/>
                <key-binding alias="CurrentSession.custom.ukey" key="To_0"/>
                <key-binding alias="null" key="From_1"/>
                <key-binding alias="null" key="To_1"/>
                <key-binding alias="null" key="From_2"/>
                <key-binding alias="null" key="To_2"/>
                <key-binding alias="null" key="From_3"/>
                <key-binding alias="null" key="To_3"/>
                <key-binding alias="null" key="From_4"/>
                <key-binding alias="null" key="To_4"/>
                <key-binding alias="null" key="From_5"/>
                <key-binding alias="null" key="To_5"/>
                <key-binding alias="null" key="From_6"/>
                <key-binding alias="null" key="To_6"/>
                <key-binding alias="null" key="From_7"/>
                <key-binding alias="null" key="To_7"/>
                <key-binding alias="null" key="From_8"/>
                <key-binding alias="null" key="To_8"/>
                <key-binding alias="null" key="From_9"/>
                <key-binding alias="null" key="To_9"/>
              </pipelet-node>
              <node-display x="0" y="1"/>
            </node>
            <transition target-connector="in1" target-path="./+1"/>
          </segment>
          <segment>
            <node>
              <join-node/>
              <node-display x="0" y="1"/>
            </node>
            <transition target-connector="in3" target-path="../+1"/>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <key-binding alias="CurrentHttpParameterMap.ukey.stringValue" key="From_0"/>
          <key-binding alias="CurrentSession.custom.ukey" key="To_0"/>
          <key-binding alias="null" key="From_1"/>
          <key-binding alias="null" key="To_1"/>
          <key-binding alias="null" key="From_2"/>
          <key-binding alias="null" key="To_2"/>
          <key-binding alias="null" key="From_3"/>
          <key-binding alias="null" key="To_3"/>
          <key-binding alias="null" key="From_4"/>
          <key-binding alias="null" key="To_4"/>
          <key-binding alias="null" key="From_5"/>
          <key-binding alias="null" key="To_5"/>
          <key-binding alias="null" key="From_6"/>
          <key-binding alias="null" key="To_6"/>
          <key-binding alias="null" key="From_7"/>
          <key-binding alias="null" key="To_7"/>
          <key-binding alias="null" key="From_8"/>
          <key-binding alias="null" key="To_8"/>
          <key-binding alias="null" key="From_9"/>
          <key-binding alias="null" key="To_9"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
      </node>
      <transition target-connector="in1" target-path="./+1">
        <transition-display>
          <bend-point relative-to="source" x="0" y="2"/>
        </transition-display>
      </transition>
    </segment>
    <segment>
      <node>
        <join-node/>
        <node-display x="-1" y="1"/>
      </node>
      <simple-transition/>
      <node>
        <decision-node condition-key="(!empty(Product) &amp;&amp; Product.custom.secure == true) || CurrentCampaignConfig.voidKeyCheck || CurrentCampaignConfig.winback || (CurrentForms.personinf.ukey !=null &amp;&amp; !empty(CurrentForms.personinf.ukey.value))" condition-operator="expr"/>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="yes">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="0" y="1"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <call-node start-name-ref="Cart-GetBasket"/>
              <node-display x="0" y="1"/>
            </node>
            <simple-transition>
              <transition-display>
                <bend-point relative-to="source" x="0" y="1"/>
              </transition-display>
            </simple-transition>
            <node>
              <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                <config-property key="Transactional" value="false"/>
                <key-binding alias="AuthCode" key="To_0"/>
                <key-binding alias="AuthType" key="To_1"/>
                <key-binding alias="null" key="From_2"/>
                <key-binding alias="null" key="To_2"/>
                <key-binding alias="null" key="From_3"/>
                <key-binding alias="null" key="To_3"/>
                <key-binding alias="null" key="From_4"/>
                <key-binding alias="null" key="To_4"/>
                <key-binding alias="null" key="From_5"/>
                <key-binding alias="null" key="To_5"/>
                <key-binding alias="null" key="From_6"/>
                <key-binding alias="null" key="To_6"/>
                <key-binding alias="null" key="From_7"/>
                <key-binding alias="null" key="To_7"/>
                <key-binding alias="null" key="From_8"/>
                <key-binding alias="null" key="To_8"/>
                <key-binding alias="null" key="From_9"/>
                <key-binding alias="null" key="To_9"/>
                <key-binding alias="CurrentCampaignConfig.voidKeyType.value" key="From_1"/>
                <key-binding alias="CurrentSession.custom.ukey" key="From_0"/>
              </pipelet-node>
              <node-display x="0" y="1"/>
            </node>
            <simple-transition>
              <transition-display>
                <bend-point relative-to="source" x="0" y="1"/>
              </transition-display>
            </simple-transition>
            <node>
              <decision-node condition-key="CurrentCampaignConfig.voidKeyType.value=='Promo'" condition-operator="expr"/>
              <node-display x="0" y="1"/>
              <branch basename="b2" source-connector="yes">
                <transition target-connector="in">
                  <transition-display>
                    <bend-point relative-to="source" x="0" y="1"/>
                  </transition-display>
                </transition>
                <segment>
                  <node>
                    <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
                      <config-property key="Transactional" value="false"/>
                      <config-property key="OnError" value="PIPELET_ERROR"/>
                      <config-property key="ScriptFile" value="common/ValidateUID.ds"/>
                      <key-binding alias="ScriptLog" key="ScriptLog"/>
                      <key-binding alias="AuthCode" key="ukey"/>
                      <key-binding alias="AuthType" key="type"/>
                    </pipelet-node>
                    <node-display x="0" y="1"/>
                    <branch basename="b2" source-connector="error">
                      <transition target-connector="in1"/>
                      <segment>
                        <node>
                          <join-node/>
                          <node-display x="2" y="0"/>
                        </node>
                        <transition target-connector="in1" target-path="../../+1/b2.1"/>
                      </segment>
                    </branch>
                  </node>
                  <transition target-connector="in1" target-path="../+1"/>
                </segment>
              </branch>
            </node>
            <transition target-connector="in1" target-path="./+1">
              <transition-display>
                <bend-point relative-to="source" x="1" y="0"/>
                <bend-point relative-to="target" x="1" y="0"/>
              </transition-display>
            </transition>
          </segment>
          <segment>
            <node>
              <join-node/>
              <node-display x="0" y="2"/>
            </node>
            <simple-transition/>
            <node>
              <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
                <config-property key="Transactional" value="false"/>
                <config-property key="OnError" value="PIPELET_ERROR"/>
                <config-property key="ScriptFile" value="grmiddleware/AuthOfferCode.ds"/>
                <key-binding alias="null" key="ScriptLog"/>
                <key-binding alias="AuthCode" key="AuthCode"/>
                <key-binding alias="ResponseCode" key="ResponseCode"/>
                <key-binding alias="CurrentRequest" key="Request"/>
              </pipelet-node>
              <node-display x="0" y="1"/>
              <branch basename="b2" source-connector="error">
                <transition target-connector="in2"/>
                <segment>
                  <node>
                    <join-node/>
                    <node-display x="2" y="0"/>
                  </node>
                  <transition target-connector="in1" target-path="../+1"/>
                </segment>
              </branch>
            </node>
            <simple-transition/>
            <node>
              <decision-node condition-key="ResponseCode == &quot;OK&quot;" condition-operator="expr"/>
              <node-display x="0" y="1"/>
              <branch basename="b3" source-connector="yes">
                <transition target-connector="in"/>
                <segment>
                  <node>
                    <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                      <config-property key="Transactional" value="true"/>
                      <key-binding alias="false" key="From_2"/>
                      <key-binding alias="AuthError" key="To_2"/>
                      <key-binding alias="null" key="From_3"/>
                      <key-binding alias="null" key="To_3"/>
                      <key-binding alias="null" key="From_4"/>
                      <key-binding alias="null" key="To_4"/>
                      <key-binding alias="null" key="From_5"/>
                      <key-binding alias="null" key="To_5"/>
                      <key-binding alias="null" key="From_6"/>
                      <key-binding alias="null" key="To_6"/>
                      <key-binding alias="null" key="From_7"/>
                      <key-binding alias="null" key="To_7"/>
                      <key-binding alias="null" key="From_8"/>
                      <key-binding alias="null" key="To_8"/>
                      <key-binding alias="null" key="From_9"/>
                      <key-binding alias="null" key="To_9"/>
                      <key-binding alias="Product.ID" key="From_1"/>
                      <key-binding alias="Basket.custom.authorizedProduct" key="To_1"/>
                    </pipelet-node>
                    <node-display x="0" y="1"/>
                  </node>
                  <simple-transition>
                    <transition-display>
                      <bend-point relative-to="source" x="0" y="1"/>
                    </transition-display>
                  </simple-transition>
                  <node>
                    <end-node/>
                    <node-display x="0" y="1"/>
                  </node>
                </segment>
              </branch>
            </node>
            <transition target-connector="in2" target-path="./+1"/>
          </segment>
          <segment>
            <node>
              <join-node/>
              <node-display x="2" y="0"/>
            </node>
            <simple-transition/>
            <node>
              <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
                <config-property key="Transactional" value="false"/>
                <key-binding alias="null" key="From_0"/>
                <key-binding alias="CurrentSession.custom.ukey" key="To_0"/>
                <key-binding alias="null" key="From_1"/>
                <key-binding alias="null" key="To_1"/>
                <key-binding alias="null" key="From_2"/>
                <key-binding alias="null" key="To_2"/>
                <key-binding alias="null" key="From_3"/>
                <key-binding alias="null" key="To_3"/>
                <key-binding alias="null" key="From_4"/>
                <key-binding alias="null" key="To_4"/>
                <key-binding alias="null" key="From_5"/>
                <key-binding alias="null" key="To_5"/>
                <key-binding alias="null" key="From_6"/>
                <key-binding alias="null" key="To_6"/>
                <key-binding alias="null" key="From_7"/>
                <key-binding alias="null" key="To_7"/>
                <key-binding alias="null" key="From_8"/>
                <key-binding alias="null" key="To_8"/>
                <key-binding alias="null" key="From_9"/>
                <key-binding alias="null" key="To_9"/>
              </pipelet-node>
              <node-display x="0" y="1"/>
            </node>
            <simple-transition/>
            <node>
              <end-node name="unauthorized"/>
              <node-display x="0" y="1"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="target" x="0" y="-2"/>
          <bend-point relative-to="target" x="0" y="-1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Assign" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <key-binding alias="null" key="From_0"/>
          <key-binding alias="CurrentSession.custom.ukey" key="To_0"/>
          <key-binding alias="null" key="From_1"/>
          <key-binding alias="null" key="To_1"/>
          <key-binding alias="null" key="From_2"/>
          <key-binding alias="null" key="To_2"/>
          <key-binding alias="null" key="From_3"/>
          <key-binding alias="null" key="To_3"/>
          <key-binding alias="null" key="From_4"/>
          <key-binding alias="null" key="To_4"/>
          <key-binding alias="null" key="From_5"/>
          <key-binding alias="null" key="To_5"/>
          <key-binding alias="null" key="From_6"/>
          <key-binding alias="null" key="To_6"/>
          <key-binding alias="null" key="From_7"/>
          <key-binding alias="null" key="To_7"/>
          <key-binding alias="null" key="From_8"/>
          <key-binding alias="null" key="To_8"/>
          <key-binding alias="null" key="From_9"/>
          <key-binding alias="null" key="To_9"/>
        </pipelet-node>
        <node-display x="2" y="1"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="_ANONYMOUS_BRANCH_27">
    <segment>
      <node>
        <text-node>
          <description>Here we should put the associated key on the Basket object so that it can persisted</description>
        </text-node>
        <node-display x="0" y="23"/>
      </node>
    </segment>
  </branch>
  <branch basename="UpdateBillingAddress">
    <segment>
      <node>
        <start-node call-mode="private" name="UpdateBillingAddress" secure="false"/>
        <node-display x="7" y="21"/>
      </node>
      <simple-transition/>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="grmiddleware/CustomerBillingAddress.ds"/>
          <key-binding alias="billingLog" key="ScriptLog"/>
          <key-binding alias="CurrentCustomer.profile.custom.accountNumber" key="accountNumber"/>
          <key-binding alias="status" key="status"/>
          <key-binding alias="CurrentForms.profile" key="addressForm"/>
          <key-binding alias="CurrentRequest.httpRemoteAddress" key="ipAddress"/>
          <key-binding alias="CurrentSession.sessionID" key="sessionId"/>
          <key-binding alias="&quot;sdasd&quot;" key="transactionID"/>
          <key-binding alias="&quot;dasdqasda&quot;" key="uid"/>
          <key-binding alias="statusMessage" key="statusMessage"/>
          <key-binding alias="dw.web.Resource.msg('Service.cartID', 'service', null)" key="cartID"/>
          <key-binding alias="CurrentRequest" key="Request"/>
          <key-binding alias="CurrentCustomer.profile.custom.mwid" key="mwid"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="1" y="0"/>
              <bend-point relative-to="source" x="1" y="-1"/>
              <bend-point relative-to="target" x="0" y="-1"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <call-node start-name-ref="Service-ScriptError"/>
              <node-display x="1" y="0"/>
            </node>
            <transition target-connector="in1" target-path="../+1"/>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <decision-node condition-key="status == '200'" condition-operator="expr"/>
        <node-display x="0" y="1"/>
        <branch basename="b3" source-connector="yes">
          <transition target-connector="in"/>
          <segment>
            <node>
              <end-node name="success"/>
              <node-display x="0" y="1"/>
            </node>
          </segment>
        </branch>
      </node>
      <transition target-connector="in2" target-path="./+1"/>
    </segment>
    <segment>
      <node>
        <join-node/>
        <node-display x="1" y="0"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node name="Error"/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="UpdateShippingAddress">
    <segment>
      <node>
        <start-node call-mode="private" name="UpdateShippingAddress" secure="false"/>
        <node-display x="11" y="21"/>
      </node>
      <simple-transition/>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="grmiddleware/CustomerShippingAddress.ds"/>
          <key-binding alias="shippingLog" key="ScriptLog"/>
          <key-binding alias="CurrentCustomer.profile.custom.accountNumber" key="accountNumber"/>
          <key-binding alias="status" key="status"/>
          <key-binding alias="CurrentForms.profile" key="addressForm"/>
          <key-binding alias="CurrentRequest.httpRemoteAddress" key="ipAddress"/>
          <key-binding alias="CurrentSession.sessionID" key="sessionId"/>
          <key-binding alias="&quot;sdasd&quot;" key="transactionID"/>
          <key-binding alias="&quot;dasdqasda&quot;" key="uid"/>
          <key-binding alias="statusMessage" key="statusMessage"/>
          <key-binding alias="dw.web.Resource.msg('Service.cartID', 'service', null)" key="cartID"/>
          <key-binding alias="CurrentRequest" key="Request"/>
          <key-binding alias="CurrentCustomer.profile.custom.mwid" key="mwid"/>
          <key-binding alias="verify" key="verify"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="1" y="0"/>
              <bend-point relative-to="source" x="1" y="-1"/>
              <bend-point relative-to="target" x="0" y="-1"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <call-node start-name-ref="Service-ScriptError"/>
              <node-display x="1" y="0"/>
            </node>
            <transition target-connector="in1" target-path="../+1"/>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <decision-node condition-key="status == '200'" condition-operator="expr"/>
        <node-display x="0" y="1"/>
        <branch basename="b3" source-connector="yes">
          <transition target-connector="in"/>
          <segment>
            <node>
              <end-node name="success"/>
              <node-display x="0" y="1"/>
            </node>
          </segment>
        </branch>
      </node>
      <transition target-connector="in2" target-path="./+1"/>
    </segment>
    <segment>
      <node>
        <join-node/>
        <node-display x="1" y="0"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node name="Error"/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="_ANONYMOUS_BRANCH_30">
    <segment>
      <node>
        <text-node>
          <description>only doing prevalidation for promos.  Not even sure if prevalidation is still needed.</description>
        </text-node>
        <node-display x="0" y="27"/>
      </node>
    </segment>
  </branch>
  <branch basename="ResetPassword">
    <segment>
      <node>
        <start-node call-mode="private" name="ResetPassword" secure="false"/>
        <node-display x="7" y="27"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="service/PasswordReset.ds"/>
          <key-binding alias="log" key="ScriptLog"/>
          <key-binding alias="CurrentForms.login.username.value" key="Login"/>
          <key-binding alias="CurrentForms.login.password.value" key="Password"/>
          <key-binding alias="loginstatus" key="loginstatus"/>
          <key-binding alias="CurrentForms.requestpassword.email.value" key="username"/>
          <key-binding alias="idstatus" key="idstatus"/>
          <key-binding alias="passwordresetstatus" key="passwordresetstatus"/>
          <key-binding alias="CurrentForms.requestpassword.email.value" key="email"/>
          <key-binding alias="CurrentRequest.httpRemoteAddress" key="ipAddress"/>
          <key-binding alias="CurrentRequest" key="Request"/>
          <key-binding alias="CurrentSession.sessionID" key="sessionId"/>
          <key-binding alias="&quot;12233445514&quot;" key="transactionID"/>
          <key-binding alias="status" key="status"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="1" y="0"/>
              <bend-point relative-to="source" x="1" y="-1"/>
              <bend-point relative-to="target" x="0" y="-1"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <call-node start-name-ref="Service-ScriptError"/>
              <node-display x="1" y="0"/>
            </node>
            <transition target-connector="in2" target-path="../+1"/>
          </segment>
        </branch>
      </node>
      <simple-transition/>
      <node>
        <decision-node condition-key="status == '200'" condition-operator="expr"/>
        <node-display x="0" y="1"/>
        <branch basename="b3" source-connector="yes">
          <transition target-connector="in"/>
          <segment>
            <node>
              <end-node name="success"/>
              <node-display x="0" y="1"/>
            </node>
          </segment>
        </branch>
      </node>
      <transition target-connector="in1" target-path="./+1"/>
    </segment>
    <segment>
      <node>
        <join-node/>
        <node-display x="1" y="0"/>
      </node>
      <simple-transition/>
      <node>
        <end-node name="fail"/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="_ANONYMOUS_BRANCH_32">
    <segment>
      <node>
        <text-node>
          <description>Flow to be called while displaying Order details of a particular Order.</description>
        </text-node>
        <node-display x="11" y="29"/>
      </node>
    </segment>
  </branch>
  <branch basename="Details">
    <segment>
      <node>
        <start-node call-mode="private" name="Details" secure="true"/>
        <node-display x="11" y="30"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="grmiddleware/OrderDetails.ds"/>
          <key-binding alias="Log" key="ScriptLog"/>
          <key-binding alias="&quot;1&quot;" key="account"/>
          <key-binding alias="&quot;2&quot;" key="brandId"/>
          <key-binding alias="CurrentHttpParameterMap.linkId.stringValue" key="link"/>
          <key-binding alias="&quot;4&quot;" key="transactionID"/>
          <key-binding alias="&quot;5&quot;" key="uid"/>
          <key-binding alias="OrderDetailsListItr" key="orderDetailsList"/>
          <key-binding alias="statusMsg" key="statusMessage"/>
          <key-binding alias="Error" key="ErrorContainer"/>
          <key-binding alias="CurrentCustomer.profile.custom.mwid" key="mwid"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="1" y="0"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <end-node name="error"/>
              <node-display orientation="horizontal" x="1" y="0"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="_ANONYMOUS_BRANCH_34">
    <segment>
      <node>
        <text-node>
          <description>Flow to be called while displaying Order history page for fetching the Continuity Info details</description>
        </text-node>
        <node-display x="13" y="29"/>
      </node>
    </segment>
  </branch>
  <branch basename="_ANONYMOUS_BRANCH_35">
    <segment>
      <node>
        <text-node>
          <description>Flow to be called while displaying Order History Page for fetching the history details of a particular custumer.</description>
        </text-node>
        <node-display x="15" y="29"/>
      </node>
    </segment>
  </branch>
  <branch basename="ContinuityInfo">
    <segment>
      <node>
        <start-node call-mode="private" name="ContinuityInfo" secure="true"/>
        <node-display x="13" y="30"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="grmiddleware/ContinuityInfo.ds"/>
          <key-binding alias="Log" key="ScriptLog"/>
          <key-binding alias="&quot;1&quot;" key="account"/>
          <key-binding alias="&quot;2&quot;" key="brandId"/>
          <key-binding alias="&quot;3&quot;" key="transactionID"/>
          <key-binding alias="&quot;4&quot;" key="uid"/>
          <key-binding alias="ContinuityObj" key="continuityObj"/>
          <key-binding alias="Errors" key="ErrorContainer"/>
          <key-binding alias="statusMsg" key="statusMessage"/>
          <key-binding alias="CurrentCustomer.profile.custom.mwid" key="mwid"/>
          <key-binding alias="CurrentRequest" key="Request"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="1" y="0"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <end-node name="error"/>
              <node-display orientation="horizontal" x="1" y="0"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="History">
    <segment>
      <node>
        <start-node call-mode="private" name="History" secure="true"/>
        <node-display x="15" y="30"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="grmiddleware/OrderHistory.ds"/>
          <key-binding alias="Log" key="ScriptLog"/>
          <key-binding alias="ContinuityObj" key="contInfoObj"/>
          <key-binding alias="ContinuityObj" key="continuityObj"/>
          <key-binding alias="OrderListItr" key="orderList"/>
          <key-binding alias="ErrorCont" key="ErrorContainer"/>
          <key-binding alias="statusmsg" key="statusMessage"/>
          <key-binding alias="CurrentCustomer.profile.custom.mwid" key="customer"/>
          <key-binding alias="CurrentCustomer.profile.custom.mwid" key="mwid"/>
          <key-binding alias="CurrentRequest" key="Request"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="1" y="0"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <end-node name="error"/>
              <node-display orientation="horizontal" x="1" y="0"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="DiagnosticAction">
    <segment>
      <node>
        <start-node call-mode="private" name="DiagnosticAction" secure="false"/>
        <node-display x="17" y="30"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="grmiddleware/Diagnostic.ds"/>
          <key-binding alias="Log" key="ScriptLog"/>
          <key-binding alias="CurrentCustomerObj.profile.custom.mwid" key="mwid"/>
          <key-binding alias="&quot;Button Click&quot;" key="action"/>
          <key-binding alias="CurrentHttpParameterMap.element.value" key="element"/>
          <key-binding alias="CurrentRequest.httpCookies['uci'].value" key="incomingUci"/>
          <key-binding alias="CurrentRequest.httpRemoteAddress" key="ipAddress"/>
          <key-binding alias="StringUtils.formatCalendar(new Calendar(),&quot;yyyy-MM-dd'T'HH:mm:ss&quot;)" key="landingDate"/>
          <key-binding alias="CurrentHttpParameterMap.screen.value" key="screen"/>
          <key-binding alias="&quot;1&quot;" key="sourceId"/>
          <key-binding alias="CurrentRequest.httpCookies['uci'].value" key="uci"/>
          <key-binding alias="CurrentSession.sessionID" key="currentSessionId"/>
          <key-binding alias="CurrentCustomerObj.profile.custom.accountNumber" key="accountNum"/>
          <key-binding alias="CurrentRequest" key="Request"/>
          <key-binding alias="ErrorCont" key="ErrorContainer"/>
          <key-binding alias="statusMessage" key="statusMessage"/>
          <key-binding alias="response" key="response"/>
          <key-binding alias="status" key="status"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="1" y="0"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <end-node/>
              <node-display orientation="horizontal" x="1" y="0"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="CustomerEmail">
    <segment>
      <node>
        <start-node call-mode="private" name="CustomerEmail" secure="false"/>
        <node-display x="19" y="30"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="grmiddleware/CustomerEmail.ds"/>
          <key-binding alias="Log" key="ScriptLog"/>
          <key-binding alias="&quot;You have to see this Proactiv Video!&quot;" key="subject"/>
          <key-binding alias="&quot;&lt;b&gt;Proactiv customer Randy is sharing a video with you:  http://www.proactiv.com/diagnosticVideo1 &lt;/b&gt;&quot;" key="bodyHtml"/>
          <key-binding alias="&quot;Proactiv customer Randy is sharing a video with you:  http://www.proactiv.com/diagnosticVideo1 &quot;" key="bodyText"/>
          <key-binding alias="CurrentSession.sessionID" key="currentSessionId"/>
          <key-binding alias="CurrentRequest.httpRemoteAddress" key="ipAddress"/>
          <key-binding alias="CurrentCustomerObj.profile.custom.mwid" key="mwid"/>
          <key-binding alias="CurrentRequest" key="Request"/>
          <key-binding alias="ErrorCont" key="ErrorContainer"/>
          <key-binding alias="statusMessage" key="statusMessage"/>
          <key-binding alias="CurrentHttpParameterMap.to.value" key="recipientTo"/>
          <key-binding alias="&quot;shareVideoLink&quot;" key="type"/>
          <key-binding alias="status" key="status"/>
          <key-binding alias="response" key="response"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="2" y="0"/>
              <bend-point relative-to="target" x="0" y="-1"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <end-node/>
              <node-display x="1" y="1"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition/>
      <node>
        <end-node/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="XSellLink">
    <segment>
      <node>
        <start-node name="XSellLink" secure="false"/>
        <node-display x="1" y="34"/>
      </node>
      <simple-transition/>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="grmiddleware/GenerateXSellLink.ds"/>
          <key-binding alias="ScriptLog" key="ScriptLog"/>
          <key-binding alias="CurrentHttpParameterMap.grcid.stringValue" key="CampaignCode"/>
          <key-binding alias="CurrentHttpParameterMap.host.stringValue" key="Host"/>
          <key-binding alias="CurrentHttpParameterMap.uci.stringValue" key="UCI"/>
          <key-binding alias="URLString" key="UrlString"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in2" target-path="./+1">
            <transition-display>
              <bend-point relative-to="source" x="2" y="0"/>
              <bend-point relative-to="target" x="2" y="0"/>
            </transition-display>
          </transition>
        </branch>
      </node>
      <transition target-connector="in1" target-path="./+1"/>
    </segment>
    <segment>
      <node>
        <join-node/>
        <node-display x="0" y="1"/>
      </node>
      <simple-transition/>
      <node>
        <interaction-node transaction-required="false">
          <template buffered="true" dynamic="false" name="util/xselllink"/>
        </interaction-node>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="ChangePassword">
    <segment>
      <node>
        <start-node call-mode="private" name="ChangePassword" secure="false"/>
        <node-display x="4" y="33"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="service/ChangePassword.ds"/>
          <key-binding alias="log" key="ScriptLog"/>
          <key-binding alias="CurrentUser.profile.credentials.login" key="username"/>
          <key-binding alias="CurrentForms.requestpassword.newpassword.value" key="newpasssword"/>
          <key-binding alias="CurrentForms.requestpassword.oldpassword.value" key="oldpassword"/>
          <key-binding alias="changepasswordstatus" key="changepasswordstatus"/>
          <key-binding alias="oldpasswordvalid" key="oldpasswordvalid"/>
          <key-binding alias="CurrentRequest.httpRemoteAddress" key="ipAddress"/>
          <key-binding alias="CurrentCustomer.profile.custom.mwid" key="mwid"/>
          <key-binding alias="CurrentSession.sessionID" key="sessionId"/>
          <key-binding alias="&quot;12233445514&quot;" key="transactionID"/>
          <key-binding alias="CurrentRequest" key="Request"/>
          <key-binding alias="status" key="status"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="1" y="0"/>
              <bend-point relative-to="source" x="1" y="-1"/>
              <bend-point relative-to="target" x="0" y="-1"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <call-node start-name-ref="Service-ScriptError"/>
              <node-display x="1" y="0"/>
            </node>
            <transition target-connector="in1" target-path="../+1"/>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <decision-node condition-key="status == '200'" condition-operator="expr"/>
        <node-display x="0" y="1"/>
        <branch basename="b3" source-connector="yes">
          <transition target-connector="in"/>
          <segment>
            <node>
              <end-node name="success"/>
              <node-display x="0" y="1"/>
            </node>
          </segment>
        </branch>
      </node>
      <transition target-connector="in1" target-path="./+1"/>
    </segment>
    <segment>
      <node>
        <join-node/>
        <node-display x="1" y="0"/>
      </node>
      <simple-transition/>
      <node>
        <end-node name="fail"/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="ShipNow">
    <segment>
      <node>
        <start-node call-mode="private" name="ShipNow" secure="false"/>
        <node-display x="7" y="33"/>
      </node>
      <simple-transition/>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="service/ShipNow.ds"/>
          <key-binding alias="shipnowlog" key="ScriptLog"/>
          <key-binding alias="dw.system.Site.current.getCustomPreferenceValue(&quot;GRMProductLine&quot;)" key="brandId"/>
          <key-binding alias="&quot;12233445514&quot;" key="transactionID"/>
          <key-binding alias="&quot;uuu&quot;" key="uid"/>
          <key-binding alias="CurrentCustomer.profile.custom.accountNumber" key="account"/>
          <key-binding alias="statusCode" key="statusCode"/>
          <key-binding alias="errorCodes" key="errorCodes"/>
          <key-binding alias="errorCode" key="errorCode"/>
          <key-binding alias="CurrentSession" key="session"/>
          <key-binding alias="CurrentRequest" key="Request"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="1" y="0"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <end-node name="error"/>
              <node-display orientation="horizontal" x="1" y="0"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node name="success"/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
  <branch basename="ReferFriend">
    <segment>
      <node>
        <start-node call-mode="private" name="ReferFriend" secure="false"/>
        <node-display x="14" y="34"/>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <pipelet-node pipelet-name="Script" pipelet-set-identifier="bc_api">
          <config-property key="Transactional" value="false"/>
          <config-property key="OnError" value="PIPELET_ERROR"/>
          <config-property key="ScriptFile" value="grmiddleware/ReferFriend.ds"/>
          <key-binding alias="Log" key="ScriptLog"/>
          <key-binding alias="&quot;1&quot;" key="account"/>
          <key-binding alias="dw.system.Site.current.getCustomPreferenceValue(&quot;GRMProductLine&quot;)" key="brandId"/>
          <key-binding alias="&quot;3&quot;" key="transactionID"/>
          <key-binding alias="&quot;4&quot;" key="uid"/>
          <key-binding alias="ContinuityObj" key="continuityObj"/>
          <key-binding alias="Errors" key="ErrorContainer"/>
          <key-binding alias="statusMsg" key="statusMessage"/>
          <key-binding alias="CurrentCustomer.profile.custom.mwid" key="mwid"/>
          <key-binding alias="CurrentRequest" key="Request"/>
          <key-binding alias="CurrentSession.sessionID" key="currentSessionId"/>
          <key-binding alias="CurrentRequest.httpRemoteAddress" key="ipAddress"/>
          <key-binding alias="CurrentSession.custom.e" key="referrerEmail"/>
          <key-binding alias="CurrentSession.custom.f" key="referrerFirstName"/>
          <key-binding alias="CurrentSession.custom.l" key="referrerLastName"/>
          <key-binding alias="dw.system.Site.current.getCustomPreferenceValue(&quot;ReferAFriendServicer&quot;)" key="servicer"/>
          <key-binding alias="CurrentSession.custom.servicerID" key="servicerID"/>
          <key-binding alias="&quot;915&quot;" key="usermpgm"/>
          <key-binding alias="CurrentSession" key="session"/>
          <key-binding alias="Order" key="order"/>
        </pipelet-node>
        <node-display x="0" y="1"/>
        <branch basename="b2" source-connector="error">
          <transition target-connector="in">
            <transition-display>
              <bend-point relative-to="source" x="1" y="0"/>
            </transition-display>
          </transition>
          <segment>
            <node>
              <end-node name="error"/>
              <node-display orientation="horizontal" x="1" y="0"/>
            </node>
          </segment>
        </branch>
      </node>
      <simple-transition>
        <transition-display>
          <bend-point relative-to="source" x="0" y="1"/>
        </transition-display>
      </simple-transition>
      <node>
        <end-node/>
        <node-display x="0" y="1"/>
      </node>
    </segment>
  </branch>
</pipeline>
